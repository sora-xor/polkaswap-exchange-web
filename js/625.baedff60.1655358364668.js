"use strict";(self["webpackChunkpolkaswap_exchange_web"]=self["webpackChunkpolkaswap_exchange_web"]||[]).push([[625],{20625:function(t,e,n){n.r(e),n.d(e,{default:function(){return N}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.parentLoading,expression:"parentLoading"}],staticClass:"container"},[n("generic-page-header",{staticClass:"page-header-title--moonpay-history",attrs:{"has-button-back":!t.isHistoryView},on:{back:t.handleBack}},[n("moonpay-logo",{attrs:{slot:"title",theme:t.libraryTheme},slot:"title"})],1),n("div",{staticClass:"moonpay-history"},[t.isHistoryView?[n("div",{staticClass:"moonpay-history-title"},[t._v(t._s(t.t("moonpay.history.title")))]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],class:["moonpay-history-list",{empty:t.emptyHistory}]},[t._l(t.formattedItems,(function(e){return n("div",{key:e.id,staticClass:"moonpay-history-item",on:{click:function(n){return t.navigateToDetails(e)}}},[n("div",{staticClass:"moonpay-history-item-data"},[n("div",{staticClass:"moonpay-history-item__date"},[t._v(t._s(e.formatted.date))]),n("div",{staticClass:"moonpay-history-item__amount"},[e.formatted.cryptoAmount?[n("formatted-amount",{staticClass:"moonpay-history-item-amount",attrs:{"value-can-be-hidden":"",value:e.formatted.cryptoAmount,"font-size-rate":t.FontSizeRate.MEDIUM,"asset-symbol":e.formatted.crypto}}),n("i",{staticClass:"s-icon--network s-icon-eth"}),t._v("  "),n("span",[t._v(t._s(t.t("forText")))]),t._v("   ")]:t._e(),n("formatted-amount",{staticClass:"moonpay-history-item-amount",attrs:{"value-can-be-hidden":"",value:e.formatted.fiatAmount,"font-size-rate":t.FontSizeRate.MEDIUM,"asset-symbol":e.formatted.fiat}})],2),n("div",{staticClass:"moonpay-history-item__wallet-address"},[t._v(" "+t._s(e.walletAddress)+" ")])]),n("s-icon",{class:["moonpay-history-item-icon",e.status],attrs:{name:e.formatted.icon,size:"14"}})],1)})),t.emptyHistory?n("span",[t._v(t._s(t.t("moonpay.history.empty")))]):t._e()],2),t.emptyHistory?t._e():n("s-pagination",{staticClass:"moonpay-history-pagination",attrs:{layout:"prev, total, next","current-page":t.currentPage,"page-size":t.pageAmount,total:t.transactions.length},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"prev-click":t.handlePrevClick,"next-click":t.handleNextClick}})]:[n("moonpay-widget",{attrs:{src:t.detailsWidgetUrl}}),t.isCompletedTransaction?n("s-button",{staticClass:"moonpay-details-button s-typography-button--large",attrs:{type:t.actionButtonType,disabled:t.actionButtonDisabled,loading:t.loading},on:{click:t.handleTransaction}},[t._v(" "+t._s(t.actionButtonText)+" ")]):t._e()]],2)],1)},r=[],o=n(83013),i=n(55005),s=n(41067),c=n(1379),u=n(7178),d=n(46108),l=n(55427),p=n(34563),h=(n(35666),n(92222),n(41539),n(78783),n(33948),n(35192),n(9653),n(21249),n(70655)),m=n(53545),y=n(8638),g=n(68006),v=n(1753),f=n(63471),w=n(85530),k=n(16546),b=n(80710),x=n(82344),T=n(74614),_=n(25108),C="history",Z="details",I=function(t){(0,d.Z)(n,t);var e=(0,l.Z)(n);function n(){var t;(0,s.Z)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return t=e.call.apply(e,[this].concat(r)),(0,p.Z)((0,u.Z)(t),"FontSizeRate",y.it.FontSizeRate),(0,p.Z)((0,u.Z)(t),"transactions",void 0),(0,p.Z)((0,u.Z)(t),"isValidNetworkType",void 0),(0,p.Z)((0,u.Z)(t),"currenciesById",void 0),(0,p.Z)((0,u.Z)(t),"libraryTheme",void 0),(0,p.Z)((0,u.Z)(t),"getTransactions",void 0),(0,p.Z)((0,u.Z)(t),"getCurrencies",void 0),(0,p.Z)((0,u.Z)(t),"unwatchEthereum",void 0),(0,p.Z)((0,u.Z)(t),"pageAmount",5),(0,p.Z)((0,u.Z)(t),"currentView",C),(0,p.Z)((0,u.Z)(t),"selectedItem",{}),t}return(0,c.Z)(n,[{key:"created",value:function(){var t=this;this.withApi((0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.initMoonpayApi(),e.next=3,Promise.all([t.getTransactions(),t.getCurrencies()]);case 3:return t.setHistory(),e.next=6,f.ZP.watchEthereum({onAccountChange:function(e){e.length?t.changeExternalWallet({address:e[0]}):t.disconnectExternalAccount()},onNetworkChange:function(e){t.setEvmNetworkType(e)},onDisconnect:function(){t.disconnectExternalAccount()}});case 6:t.unwatchEthereum=e.sent;case 7:case"end":return e.stop()}}),e)}))))}},{key:"beforeDestroy",value:function(){"function"===typeof this.unwatchEthereum&&this.unwatchEthereum()}},{key:"emptyHistory",get:function(){return 0===this.transactions.length}},{key:"historyItems",get:function(){return this.getPageItems(this.transactions)}},{key:"formattedItems",get:function(){var t=this.currenciesById,e=this.historyItems,n=this.formatDate,a=function(e){var n,a;return(null!==(n=null===(a=t[e])||void 0===a?void 0:a.code)&&void 0!==n?n:"").toUpperCase()},r=function(t){return Number.isFinite(t)?String(t):t},i=function(t){return t===x.D.Completed?"basic-check-mark-24":t===x.D.Failed?"basic-clear-X-24":"basic-more-horizontal-24"};return e.map((function(t){return(0,o.Z)((0,o.Z)({},t),{},{formatted:{fiat:a(t.baseCurrencyId),fiatAmount:r(t.baseCurrencyAmount),crypto:a(t.currencyId),cryptoAmount:r(t.quoteCurrencyAmount),date:n(new Date(t.updatedAt).getTime()),icon:i(t.status)}})}))}},{key:"detailsWidgetUrl",get:function(){if(!this.selectedItem.id)return"";var t=(0,w.UK)({colorCode:(0,w.y_)("--s-color-theme-accent"),language:this.language,transactionId:this.selectedItem.id});return"".concat(this.selectedItem.returnUrl,"?").concat(t)}},{key:"bridgeTxToSora",get:function(){if(this.selectedItem.id)return this.getBridgeHistoryItemByMoonpayId(this.selectedItem.id)}},{key:"isCompletedTransaction",get:function(){var t;return(null===(t=this.selectedItem)||void 0===t?void 0:t.status)===x.D.Completed}},{key:"externalAccountIsMoonpayRecipient",get:function(){var t,e,n;return(null===(t=this.selectedItem)||void 0===t||null===(e=t.walletAddress)||void 0===e||null===(n=e.toLowerCase)||void 0===n?void 0:n.call(e))===this.evmAddress.toLowerCase()}},{key:"actionButtonType",get:function(){return this.bridgeTxToSora?"secondary":"primary"}},{key:"actionButtonDisabled",get:function(){return!this.bridgeTxToSora&&(!this.externalAccountIsMoonpayRecipient||!this.isValidNetworkType)}},{key:"actionButtonText",get:function(){return this.isExternalAccountConnected?this.bridgeTxToSora?this.t("moonpay.buttons.view"):this.externalAccountIsMoonpayRecipient?this.isValidNetworkType?this.t("moonpay.buttons.transfer"):this.t("bridgeTransaction.changeNetwork"):this.t("bridgeTransaction.changeAccount"):this.t("connectWalletText")}},{key:"isHistoryView",get:function(){return this.currentView===C}},{key:"changeView",value:function(t){this.currentView=t}},{key:"handleBack",value:function(){this.loading=!1,this.changeView(C)}},{key:"navigateToDetails",value:function(){var t=(0,i.Z)(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.checkConnectionToExternalAccount((0,i.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.prepareEvmNetwork();case 2:n.selectedItem=e,n.changeView(Z);case 4:case"end":return t.stop()}}),t)}))));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),_.error(t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"handleTransaction",value:function(){var t=(0,i.Z)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.selectedItem.id){t.next=2;break}return t.abrupt("return");case 2:if(null===(e=this.bridgeTxToSora)||void 0===e||!e.id){t.next=9;break}return t.next=5,this.prepareEvmNetwork(this.bridgeTxToSora.externalNetwork);case 5:return t.next=7,this.showHistory(this.bridgeTxToSora.id);case 7:t.next=11;break;case 9:return t.next=11,this.prepareMoonpayTxForBridgeTransfer(this.selectedItem);case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),n}((0,m.Wr)(y.tA.PaginationSearchMixin,g.Z));(0,h.__decorate)([T.SB.moonpay.transactions],I.prototype,"transactions",void 0),(0,h.__decorate)([T.Yn.web3.isValidNetworkType],I.prototype,"isValidNetworkType",void 0),(0,h.__decorate)([T.Yn.moonpay.currenciesById],I.prototype,"currenciesById",void 0),(0,h.__decorate)([T.Yn.libraryTheme],I.prototype,"libraryTheme",void 0),(0,h.__decorate)([T.aD.moonpay.getTransactions],I.prototype,"getTransactions",void 0),(0,h.__decorate)([T.aD.moonpay.getCurrencies],I.prototype,"getCurrencies",void 0),I=(0,h.__decorate)([(0,m.wA)({components:{MoonpayLogo:v["default"],FormattedAmount:y.wx.FormattedAmount,GenericPageHeader:(0,b.kF)(k.z8.GenericPageHeader),MoonpayWidget:(0,b.kF)(k.z8.MoonpayWidget)}})],I);var A=I,B=A,E=n(1001),D=(0,E.Z)(B,a,r,!1,null,"fbfa0c22",null),N=D.exports}}]);