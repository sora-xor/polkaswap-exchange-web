"use strict";(self["webpackChunkpolkaswap_exchange_web"]=self["webpackChunkpolkaswap_exchange_web"]||[]).push([[7771],{47771:function(e,t,r){r.r(t),r.d(t,{default:function(){return E}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.parentLoading,expression:"parentLoading"}],staticClass:"rewards"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:!e.parentLoading&&e.loading,expression:"!parentLoading && loading"}],staticClass:"rewards-content"},[r("gradient-box",{staticClass:"rewards-block",attrs:{symbol:e.gradientSymbol}},[r("div",{class:["rewards-box",e.libraryTheme]},[r("tokens-row",{attrs:{symbols:e.rewardTokenSymbols}}),e.claimingInProgressOrFinished?r("div",{staticClass:"rewards-claiming-text"},[e._v(" "+e._s(e.claimingStatusMessage)+" ")]):e._e(),e.isSoraAccountConnected?r("div",{staticClass:"rewards-amount"},[r("rewards-amount-header",{attrs:{items:e.rewardsByAssetsList}}),e.claimingInProgressOrFinished?e._e():[e.internalRewards?r("rewards-amount-table",{staticClass:"rewards-table",attrs:{item:e.internalRewards,theme:e.libraryTheme,disabled:!e.internalRewardsAvailable,"is-codec-string":""},model:{value:e.selectedInternalRewardsModel,callback:function(t){e.selectedInternalRewardsModel=t},expression:"selectedInternalRewardsModel"}}):e._e(),r("rewards-amount-table",{staticClass:"rewards-table",attrs:{item:e.vestedRewadsGroupItem,theme:e.libraryTheme,disabled:!e.vestedRewardsAvailable,"is-codec-string":""},model:{value:e.selectedVestedRewardsModel,callback:function(t){e.selectedVestedRewardsModel=t},expression:"selectedVestedRewardsModel"}}),r("rewards-amount-table",{staticClass:"rewards-table",attrs:{item:e.crowdloanRewardsGroupItem,theme:e.libraryTheme,"complex-group":"","is-codec-string":""},model:{value:e.selectedCrowdloanRewardsModel,callback:function(t){e.selectedCrowdloanRewardsModel=t},expression:"selectedCrowdloanRewardsModel"}}),r("rewards-amount-table",{staticClass:"rewards-table",attrs:{item:e.externalRewardsGroupItem,"show-table":!!e.externalRewards.length,theme:e.libraryTheme,"simple-group":""},model:{value:e.selectedExternalRewardsModel,callback:function(t){e.selectedExternalRewardsModel=t},expression:"selectedExternalRewardsModel"}},[r("div",{staticClass:"rewards-footer"},[r("s-divider"),e.isExternalAccountConnected?r("div",{staticClass:"rewards-account"},[r("span",[e._v(e._s(e.formatAddress(e.evmAddress,8)))]),r("span",[e._v(e._s(e.t("rewards.connected")))])]):r("s-button",{staticClass:"rewards-connect-button",attrs:{type:"tertiary"},on:{click:e.connectExternalAccountProcess}},[e._v(" "+e._s(e.t("rewards.action.connectExternalWallet"))+" ")]),e.externalRewardsHintText?r("div",{staticClass:"rewards-footer-hint"},[e._v(e._s(e.externalRewardsHintText))]):e._e()],1)]),e.fee&&e.isSoraAccountConnected&&e.rewardsAvailable&&!e.claimingInProgressOrFinished?r("info-line",e._b({class:["rewards-fee",e.libraryTheme],attrs:{"fiat-value":e.getFiatAmountByCodecString(e.fee),"is-formatted":""}},"info-line",e.feeInfo,!1)):e._e()]],2):e._e(),e.claimingInProgressOrFinished?r("div",{staticClass:"rewards-claiming-text--transaction"},[e._v(" "+e._s(e.transactionStatusMessage)+" ")]):e._e()],1)]),!e.claimingInProgressOrFinished&&e.hintText?r("div",{staticClass:"rewards-block rewards-hint"},[e._v(" "+e._s(e.hintText)+" ")]):e._e(),e.rewardsRecieved||e.loading?e._e():r("s-button",{staticClass:"rewards-block rewards-action-button s-typography-button--large",attrs:{type:"primary",loading:e.actionButtonLoading,disabled:e.actionButtonDisabled},on:{click:e.handleAction}},[e._v(" "+e._s(e.actionButtonText)+" ")])],1)])},a=[],s=r(83013),i=r(55005),o=r(41067),d=r(1379),c=r(7178),l=r(46108),u=r(55427),w=r(34563),h=(r(35666),r(92222),r(21249),r(26699),r(32023),r(69600),r(70655)),v=r(53545),p=r(8638),m=r(36930),R=r(82753),g=r(63471),f=r(80710),b=r(16546),x=r(85530),y=r(74614),_=r(10909),k=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;(0,o.Z)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a)),(0,w.Z)((0,c.Z)(e),"feeFetching",void 0),(0,w.Z)((0,c.Z)(e),"rewardsFetching",void 0),(0,w.Z)((0,c.Z)(e),"rewardsClaiming",void 0),(0,w.Z)((0,c.Z)(e),"transactionError",void 0),(0,w.Z)((0,c.Z)(e),"transactionStep",void 0),(0,w.Z)((0,c.Z)(e),"fee",void 0),(0,w.Z)((0,c.Z)(e),"rewardsRecieved",void 0),(0,w.Z)((0,c.Z)(e),"vestedRewards",void 0),(0,w.Z)((0,c.Z)(e),"crowdloanRewards",void 0),(0,w.Z)((0,c.Z)(e),"internalRewards",void 0),(0,w.Z)((0,c.Z)(e),"externalRewards",void 0),(0,w.Z)((0,c.Z)(e),"selectedVestedRewards",void 0),(0,w.Z)((0,c.Z)(e),"selectedInternalRewards",void 0),(0,w.Z)((0,c.Z)(e),"selectedExternalRewards",void 0),(0,w.Z)((0,c.Z)(e),"selectedCrowdloanRewards",void 0),(0,w.Z)((0,c.Z)(e),"xor",void 0),(0,w.Z)((0,c.Z)(e),"transactionStepsCount",void 0),(0,w.Z)((0,c.Z)(e),"externalRewardsAvailable",void 0),(0,w.Z)((0,c.Z)(e),"rewardsAvailable",void 0),(0,w.Z)((0,c.Z)(e),"internalRewardsAvailable",void 0),(0,w.Z)((0,c.Z)(e),"vestedRewardsAvailable",void 0),(0,w.Z)((0,c.Z)(e),"rewardsByAssetsList",void 0),(0,w.Z)((0,c.Z)(e),"libraryTheme",void 0),(0,w.Z)((0,c.Z)(e),"nodeIsConnected",void 0),(0,w.Z)((0,c.Z)(e),"reset",void 0),(0,w.Z)((0,c.Z)(e),"setSelectedRewards",void 0),(0,w.Z)((0,c.Z)(e),"getExternalRewards",void 0),(0,w.Z)((0,c.Z)(e),"claimRewards",void 0),(0,w.Z)((0,c.Z)(e),"subscribeOnRewards",void 0),(0,w.Z)((0,c.Z)(e),"unsubscribeFromRewards",void 0),(0,w.Z)((0,c.Z)(e),"unwatchEthereum",void 0),e}return(0,d.Z)(r,[{key:"updateSubscriptions",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}if(this.loading){e.next=4;break}return e.next=4,this.subscribeOnRewards();case 4:e.next=8;break;case 6:return e.next=8,this.unsubscribeFromRewards();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"destroyed",value:function(){this.reset()}},{key:"created",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.withApi((0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.setEvmNetworkType();case 2:return e.next=4,t.syncExternalAccountWithAppState();case 4:return e.next=6,t.checkExternalRewards();case 6:return e.next=8,t.subscribeOnRewards();case 8:return e.next=10,g.ZP.watchEthereum({onAccountChange:function(e){e.length?t.changeExternalAccountProcess({address:e[0]}):t.disconnectExternalAccountProcess()},onNetworkChange:function(e){t.setEvmNetworkType(e)},onDisconnect:function(){t.disconnectExternalAccountProcess()}});case 10:t.unwatchEthereum=e.sent;case 11:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"beforeDestroy",value:function(){this.unsubscribeFromRewards(),"function"===typeof this.unwatchEthereum&&this.unwatchEthereum()}},{key:"externalRewardsGroupItem",get:function(){return{type:this.t("rewards.groups.external"),limit:(0,p.fG)(this.externalRewards),rewards:this.externalRewards}}},{key:"vestedRewadsGroupItem",get:function(){var e,t,r,n,a,s,i=null!==(e=null===(t=this.vestedRewards)||void 0===t?void 0:t.rewards)&&void 0!==e?e:[],o=R.KnownAssets.get(R.KnownSymbols.PSWAP);return{type:this.t("rewards.groups.strategic"),title:this.t("rewards.claimableAmountDoneVesting"),limit:[{amount:m.FPNumber.fromCodecValue(null!==(r=null===(n=this.vestedRewards)||void 0===n?void 0:n.limit)&&void 0!==r?r:0,o.decimals).toCodecString(),asset:o}],total:{amount:m.FPNumber.fromCodecValue(null!==(a=null===(s=this.vestedRewards)||void 0===s?void 0:s.total)&&void 0!==a?a:0,o.decimals).toLocaleString(),asset:o},rewards:i}}},{key:"crowdloanRewardsGroupItem",get:function(){return{type:this.t("rewards.groups.crowdloan"),rewards:this.crowdloanRewards.map((function(e){var t;return(0,s.Z)((0,s.Z)({},e),{},{total:m.FPNumber.fromCodecValue(null!==(t=e.total)&&void 0!==t?t:0,e.asset.decimals).toLocaleString()})}))}}},{key:"selectedInternalRewardsModel",get:function(){return this.internalRewardsAvailable&&null!==this.selectedInternalRewards},set:function(e){var t=e?this.internalRewards:null;this.setSelectedRewards({selectedInternal:t})}},{key:"selectedExternalRewardsModel",get:function(){return 0!==this.selectedExternalRewards.length},set:function(e){var t=e?this.externalRewards:[];this.setSelectedRewards({selectedExternal:t})}},{key:"selectedVestedRewardsModel",get:function(){return this.vestedRewardsAvailable&&null!==this.selectedVestedRewards},set:function(e){var t=e?this.vestedRewards:null;this.setSelectedRewards({selectedVested:t})}},{key:"selectedCrowdloanRewardsModel",get:function(){return this.selectedCrowdloanRewards.map((function(e){return e.type}))},set:function(e){var t=this.crowdloanRewards.reduce((function(t,r){return e.includes(r.type)&&t.push(r),t}),[]);this.setSelectedRewards({selectedCrowdloan:t})}},{key:"isInsufficientBalance",get:function(){return(0,x.LG)(this.xor,this.fee)}},{key:"feeInfo",get:function(){return{label:this.t("rewards.networkFee"),labelTooltip:this.t("rewards.networkFeeTooltip"),value:this.formatCodecNumber(this.fee),assetSymbol:R.KnownSymbols.XOR}}},{key:"claimingInProgressOrFinished",get:function(){return this.rewardsClaiming||this.transactionError||this.rewardsRecieved}},{key:"claimingStatusMessage",get:function(){return this.rewardsRecieved?this.t("rewards.claiming.success"):this.t("rewards.claiming.pending")}},{key:"transactionStatusMessage",get:function(){if(this.rewardsRecieved)return this.t("rewards.transactions.success");var e=this.tOrdinal(this.transactionStep),t=this.transactionError?"rewards.transactions.failed":"rewards.transactions.confimation";return this.t(t,{order:e,total:this.transactionStepsCount})}},{key:"rewardTokenSymbols",get:function(){return this.rewardsByAssetsList.map((function(e){return e.asset.symbol}))}},{key:"gradientSymbol",get:function(){return 1===this.rewardTokenSymbols.length?this.rewardTokenSymbols[0]:""}},{key:"hintText",get:function(){if(!this.isSoraAccountConnected)return this.t("rewards.hint.connectAccounts");if(this.rewardsAvailable){var e=this.rewardTokenSymbols.join(" ".concat(this.t("rewards.andText")," ")),t=this.tc("transactionText",this.transactionStepsCount),r=this.transactionStepsCount>1?this.transactionStepsCount:"",n=this.transactionStepsCount>1?this.t("rewards.signing.accounts"):this.t("rewards.signing.extension");return this.t("rewards.hint.howToClaimRewards",{symbols:e,transactions:t,count:r,destination:n})}return""}},{key:"externalRewardsHintText",get:function(){return this.isExternalAccountConnected?this.externalRewardsAvailable?"":this.t("rewards.hint.connectAnotherAccount"):this.t("rewards.hint.connectExternalAccount")}},{key:"actionButtonText",get:function(){return this.actionButtonLoading?"":this.isSoraAccountConnected?this.transactionError?this.t("rewards.action.retry"):this.isInsufficientBalance?this.t("rewards.action.insufficientBalance",{tokenSymbol:R.KnownSymbols.XOR}):this.rewardsClaiming?this.externalRewardsAvailable&&1===this.transactionStep?this.t("rewards.action.pendingExternal"):this.externalRewardsAvailable&&2!==this.transactionStep?"":this.t("rewards.action.pendingInternal"):this.t("rewards.action.signAndClaim"):this.t("rewards.action.connectWallet")}},{key:"actionButtonLoading",get:function(){return this.rewardsFetching||this.feeFetching}},{key:"actionButtonDisabled",get:function(){return this.rewardsClaiming||this.isSoraAccountConnected&&(!this.rewardsAvailable||this.isInsufficientBalance)}},{key:"handleAction",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.isSoraAccountConnected){e.next=2;break}return e.abrupt("return",this.connectInternalWallet());case 2:if(!this.rewardsAvailable){e.next=6;break}return e.next=5,this.claimRewardsProcess();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkExternalRewards",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){var t,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]&&r[0],!this.isSoraAccountConnected){e.next=4;break}return e.next=4,this.getRewardsProcess(t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getRewardsProcess",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){var t,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.next=3,this.getExternalRewards(this.evmAddress);case 3:!this.rewardsAvailable&&t&&this.$notify({message:this.t("rewards.notification.empty"),title:""});case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"connectExternalAccountProcess",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.connectExternalWallet();case 2:return e.next=4,this.checkExternalRewards();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"disconnectExternalAccountProcess",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.disconnectExternalAccount(),e.next=3,this.checkExternalRewards();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeExternalAccountProcess",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.changeExternalWallet(t);case 2:return e.next=4,this.checkExternalRewards();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"claimRewardsProcess",value:function(){var e=(0,i.Z)(regeneratorRuntime.mark((function e(){var t,r,n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.getWalletAddress(),r=this.evmAddress,t){e.next=4;break}return e.abrupt("return");case 4:if(!r){e.next=10;break}return e.next=7,g.ZP.checkAccountIsConnected(r);case 7:if(n=e.sent,n){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,this.withNotifications((0,i.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.claimRewards({internalAddress:t,externalAddress:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),r}((0,v.Wr)(p.tA.FormattedAmountMixin,_.Z,p.tA.TransactionMixin));(0,h.__decorate)([y.SB.rewards.feeFetching],k.prototype,"feeFetching",void 0),(0,h.__decorate)([y.SB.rewards.rewardsFetching],k.prototype,"rewardsFetching",void 0),(0,h.__decorate)([y.SB.rewards.rewardsClaiming],k.prototype,"rewardsClaiming",void 0),(0,h.__decorate)([y.SB.rewards.transactionError],k.prototype,"transactionError",void 0),(0,h.__decorate)([y.SB.rewards.transactionStep],k.prototype,"transactionStep",void 0),(0,h.__decorate)([y.SB.rewards.fee],k.prototype,"fee",void 0),(0,h.__decorate)([y.SB.rewards.rewardsRecieved],k.prototype,"rewardsRecieved",void 0),(0,h.__decorate)([y.SB.rewards.vestedRewards],k.prototype,"vestedRewards",void 0),(0,h.__decorate)([y.SB.rewards.crowdloanRewards],k.prototype,"crowdloanRewards",void 0),(0,h.__decorate)([y.SB.rewards.internalRewards],k.prototype,"internalRewards",void 0),(0,h.__decorate)([y.SB.rewards.externalRewards],k.prototype,"externalRewards",void 0),(0,h.__decorate)([y.SB.rewards.selectedVested],k.prototype,"selectedVestedRewards",void 0),(0,h.__decorate)([y.SB.rewards.selectedInternal],k.prototype,"selectedInternalRewards",void 0),(0,h.__decorate)([y.SB.rewards.selectedExternal],k.prototype,"selectedExternalRewards",void 0),(0,h.__decorate)([y.SB.rewards.selectedCrowdloan],k.prototype,"selectedCrowdloanRewards",void 0),(0,h.__decorate)([y.Yn.assets.xor],k.prototype,"xor",void 0),(0,h.__decorate)([y.Yn.rewards.transactionStepsCount],k.prototype,"transactionStepsCount",void 0),(0,h.__decorate)([y.Yn.rewards.externalRewardsAvailable],k.prototype,"externalRewardsAvailable",void 0),(0,h.__decorate)([y.Yn.rewards.rewardsAvailable],k.prototype,"rewardsAvailable",void 0),(0,h.__decorate)([y.Yn.rewards.internalRewardsAvailable],k.prototype,"internalRewardsAvailable",void 0),(0,h.__decorate)([y.Yn.rewards.vestedRewardsAvailable],k.prototype,"vestedRewardsAvailable",void 0),(0,h.__decorate)([y.Yn.rewards.rewardsByAssetsList],k.prototype,"rewardsByAssetsList",void 0),(0,h.__decorate)([y.Yn.libraryTheme],k.prototype,"libraryTheme",void 0),(0,h.__decorate)([y.Yn.settings.nodeIsConnected],k.prototype,"nodeIsConnected",void 0),(0,h.__decorate)([y.QF.rewards.reset],k.prototype,"reset",void 0),(0,h.__decorate)([y.aD.rewards.setSelectedRewards],k.prototype,"setSelectedRewards",void 0),(0,h.__decorate)([y.aD.rewards.getExternalRewards],k.prototype,"getExternalRewards",void 0),(0,h.__decorate)([y.aD.rewards.claimRewards],k.prototype,"claimRewards",void 0),(0,h.__decorate)([y.aD.rewards.subscribeOnRewards],k.prototype,"subscribeOnRewards",void 0),(0,h.__decorate)([y.aD.rewards.unsubscribeFromRewards],k.prototype,"unsubscribeFromRewards",void 0),(0,h.__decorate)([(0,v.RL)("isSoraAccountConnected"),(0,v.RL)("nodeIsConnected")],k.prototype,"updateSubscriptions",null),k=(0,h.__decorate)([(0,v.wA)({components:{GenericPageHeader:(0,f.kF)(b.z8.GenericPageHeader),GradientBox:(0,f.kF)(b.z8.GradientBox),TokensRow:(0,f.kF)(b.z8.TokensRow),RewardsAmountHeader:(0,f.kF)(b.z8.RewardsAmountHeader),RewardsAmountTable:(0,f.kF)(b.z8.RewardsAmountTable),InfoLine:p.wx.InfoLine}})],k);var Z=k,A=Z,S=r(1001),C=(0,S.Z)(A,n,a,!1,null,"3ac48077",null),E=C.exports}}]);