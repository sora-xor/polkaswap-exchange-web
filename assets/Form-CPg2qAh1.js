var L=Object.defineProperty;var T=(u,e,t)=>e in u?L(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var i=(u,e,t)=>T(u,typeof e!="symbol"?e+"":e,t);import{m as b,$ as f,X as k,hG as m,b as d,aj as _,aJ as A,g as p,h as a,i as q,k as y,W as P,C as B,hd as F,he as g,l as v,j as h,_ as C,n as w}from"./index-BHqySXo4.js";import{C as x}from"./ConfirmDialogMixin-BYoYOPfg.js";import{N as D}from"./NetworkFeeDialogMixin-DEf8HRG3.js";var R=Object.defineProperty,N=Object.getOwnPropertyDescriptor,n=(u,e,t,r)=>{for(var s=r>1?void 0:r?N(e,t):e,l=u.length-1,c;l>=0;l--)(c=u[l])&&(s=(r?c(e,t,s):c(s))||s);return r&&s&&R(e,t,s),s};let o=class extends b(f.NetworkFeeWarningMixin,f.FormattedAmountMixin,f.TransactionMixin,x,D){constructor(){super(...arguments);i(this,"XOR_SYMBOL",k.symbol);i(this,"MAX_PART",100);i(this,"FocusedField",m);i(this,"liquidityAmount");i(this,"focusedField");i(this,"firstTokenAmount");i(this,"secondTokenAmount");i(this,"removePart");i(this,"xor");i(this,"liquidityBalanceFull");i(this,"liquidityBalance");i(this,"demeterLockedBalance");i(this,"ceresLockedBalance");i(this,"liquidity");i(this,"firstToken");i(this,"secondToken");i(this,"firstTokenBalance");i(this,"secondTokenBalance");i(this,"shareOfPool");i(this,"price");i(this,"priceReversed");i(this,"setFocusedField");i(this,"resetFocusedField");i(this,"setRemovePart");i(this,"removeLiquidity");i(this,"setFirstTokenAmount");i(this,"setSecondTokenAmount");i(this,"sliderInput");i(this,"sliderDragButton")}liquidityChange(){switch(this.focusedField){case m.First:case m.Second:{const e=this.focusedField===m.First,t=Number(this.getTokenMaxAmount(e?this.firstTokenBalance:this.secondTokenBalance)),r=Number(e?this.firstTokenAmount:this.secondTokenAmount),s=e?this.setFirstTokenAmount:this.setSecondTokenAmount,l=String(Number.isFinite(t)?Math.min(t,r):r);s(l);break}default:{this.setRemovePart(this.removePart);break}}}mounted(){this.addListenerToSliderDragButton()}beforeDestroy(){this.removeListenerFromSliderDragButton()}get sliderValue(){return this.removePart?Number(this.removePart):void 0}get isEmptyAmount(){return!Number(this.liquidityAmount)||!this.firstTokenAmount||!this.secondTokenAmount}get liquidityLocked(){return this.liquidityBalance.isZero()}get locks(){return[{balance:this.demeterLockedBalance,lock:"Demeter Farming"},{balance:this.ceresLockedBalance,lock:"Ceres Liquidity Locker"}].reduce((e,{balance:t,lock:r})=>(t.isZero()||e.push({lock:r,percent:this.getLockedPercent(t)}),e),[])}get isInsufficientBalance(){const{liquidityBalance:e,firstTokenBalance:t,secondTokenBalance:r}=this,s=this.getFPNumber(this.liquidityAmount),l=this.getFPNumber(this.firstTokenAmount),c=this.getFPNumber(this.secondTokenAmount);return d.FPNumber.gt(s,e)||d.FPNumber.gt(l,t)||d.FPNumber.gt(c,r)}get isInsufficientXorForFee(){return!!this.xor&&_(this.xor,this.networkFee)}get removePartCharClass(){return`${{3:"three",2:"two"}[this.removePart.length]??"one"}-char`}get networkFee(){return this.networkFees[d.Operation.RemoveLiquidity]}get formattedFee(){return this.formatCodecNumber(this.networkFee)}get isXorSufficientForNextOperation(){var t;const e={type:d.Operation.RemoveLiquidity};return((t=this.firstToken)==null?void 0:t.address)===k.address&&(e.amount=this.getFPNumber(this.firstTokenAmount),e.isXor=!0),this.isXorSufficientForNextTx(e)}get isMaxButtonAvailable(){return this.shouldBalanceBeHidden?!1:!this.liquidityLocked&&Number(this.removePart)!==this.MAX_PART}handleRemovePartChange(e){Number(e)!==Number(this.removePart)&&this.setRemovePart(String(e))}focusSliderInput(){this.setFocusedField(m.Percent),this.sliderInput&&this.sliderInput.focus()}getTokenMaxAmount(e){return e.toString()}getLockedPercent(e){const t=e.div(this.liquidityBalanceFull).mul(d.FPNumber.HUNDRED);return A(t,!0)}async handleTokenChange(e,t){await t(e)}async withdrawLiquidity(){await this.withNotifications(async()=>{await this.removeLiquidity(),this.$emit("back")})}async handleRemoveLiquidity(){if(this.allowFeePopup&&!this.isXorSufficientForNextOperation){if(this.openWarningFeeDialog(),await this.waitOnFeeWarningConfirmation(),!this.isWarningFeeDialogConfirmed)return;this.isWarningFeeDialogConfirmed=!1}this.confirmOrExecute(this.withdrawLiquidity)}addListenerToSliderDragButton(){this.sliderDragButton=this.$el.querySelector(".slider-container .el-slider__button"),this.sliderInput=this.$el.querySelector(".s-input--remove-part .el-input__inner"),this.sliderDragButton&&this.sliderDragButton.addEventListener("mousedown",this.focusSliderInput)}removeListenerFromSliderDragButton(){this.sliderDragButton&&this.$el.removeEventListener("mousedown",this.sliderDragButton)}};n([p.removeLiquidity.liquidityAmount],o.prototype,"liquidityAmount",2);n([p.removeLiquidity.focusedField],o.prototype,"focusedField",2);n([p.removeLiquidity.firstTokenAmount],o.prototype,"firstTokenAmount",2);n([p.removeLiquidity.secondTokenAmount],o.prototype,"secondTokenAmount",2);n([p.removeLiquidity.removePart],o.prototype,"removePart",2);n([a.assets.xor],o.prototype,"xor",2);n([a.removeLiquidity.liquidityBalanceFull],o.prototype,"liquidityBalanceFull",2);n([a.removeLiquidity.liquidityBalance],o.prototype,"liquidityBalance",2);n([a.removeLiquidity.demeterLockedBalance],o.prototype,"demeterLockedBalance",2);n([a.removeLiquidity.ceresLockedBalance],o.prototype,"ceresLockedBalance",2);n([a.removeLiquidity.liquidity],o.prototype,"liquidity",2);n([a.removeLiquidity.firstToken],o.prototype,"firstToken",2);n([a.removeLiquidity.secondToken],o.prototype,"secondToken",2);n([a.removeLiquidity.firstTokenBalance],o.prototype,"firstTokenBalance",2);n([a.removeLiquidity.secondTokenBalance],o.prototype,"secondTokenBalance",2);n([a.removeLiquidity.shareOfPool],o.prototype,"shareOfPool",2);n([a.removeLiquidity.price],o.prototype,"price",2);n([a.removeLiquidity.priceReversed],o.prototype,"priceReversed",2);n([q.removeLiquidity.setFocusedField],o.prototype,"setFocusedField",2);n([q.removeLiquidity.resetFocusedField],o.prototype,"resetFocusedField",2);n([y.removeLiquidity.setRemovePart],o.prototype,"setRemovePart",2);n([y.removeLiquidity.removeLiquidity],o.prototype,"removeLiquidity",2);n([y.removeLiquidity.setFirstTokenAmount],o.prototype,"setFirstTokenAmount",2);n([y.removeLiquidity.setSecondTokenAmount],o.prototype,"setSecondTokenAmount",2);n([P("liquidity",{deep:!0})],o.prototype,"liquidityChange",1);o=n([B({components:{RemoveLiquidityConfirm:F(g.RemoveLiquidityConfirm),RemoveLiquidityTransactionDetails:F(g.RemoveLiquidityTransactionDetails),SlippageTolerance:v(h.SlippageTolerance),NetworkFeeWarningDialog:v(h.NetworkFeeWarningDialog),TokenInput:v(h.TokenInput),InfoLine:C.InfoLine}})],o);var S=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[t("s-float-input",{ref:"removePart",class:["s-input--remove-part",e.removePartCharClass],attrs:{size:"medium",value:e.removePart,decimals:0,disabled:e.liquidityLocked,max:e.MAX_PART},on:{input:e.handleRemovePartChange,focus:function(r){return e.setFocusedField(e.FocusedField.Percent)},blur:e.resetFocusedField}},[t("div",{staticClass:"input-title",attrs:{slot:"top"},slot:"top"},[e._v(e._s(e.t("removeLiquidity.amount")))]),t("div",{staticClass:"el-buttons el-buttons--between",attrs:{slot:"right"},slot:"right"},[t("span",{staticClass:"percent"},[e._v("%")]),e.isMaxButtonAvailable?t("s-button",{staticClass:"el-button--max s-typography-button--small",attrs:{type:"primary",alternative:"",size:"mini","border-radius":"mini"},on:{click:function(r){return r.stopPropagation(),e.handleRemovePartChange(e.MAX_PART)}}},[e._v(" "+e._s(e.t("buttons.max"))+" ")]):e._e()],1),t("div",{attrs:{slot:"bottom"},slot:"bottom"},[t("s-slider",{staticClass:"slider-container",attrs:{value:e.sliderValue,disabled:e.liquidityLocked,"show-tooltip":!1},on:{input:e.handleRemovePartChange}}),e._l(e.locks,function({percent:r,lock:s}){return t("div",{key:s,staticClass:"input-line input-line--footer locked-part"},[t("span",{staticClass:"locked-part-percent"},[e._v(e._s(r))]),e._v(" "+e._s(e.t("removeLiquidity.locked",{lock:s}))+" ")])})],2)]),t("s-icon",{staticClass:"icon-divider",attrs:{name:"arrows-arrow-bottom-24"}}),t("token-input",{attrs:{disabled:e.liquidityLocked,max:e.getTokenMaxAmount(e.firstTokenBalance),title:e.t("removeLiquidity.output"),token:e.firstToken,value:e.firstTokenAmount},on:{input:e.setFirstTokenAmount,focus:function(r){return e.setFocusedField(e.FocusedField.First)},blur:e.resetFocusedField},scopedSlots:e._u([{key:"balance",fn:function(){return[e._v("-")]},proxy:!0}])}),t("s-icon",{staticClass:"icon-divider",attrs:{name:"plus-16"}}),t("token-input",{attrs:{disabled:e.liquidityLocked,max:e.getTokenMaxAmount(e.secondTokenBalance),title:e.t("removeLiquidity.output"),token:e.secondToken,value:e.secondTokenAmount},on:{input:e.setSecondTokenAmount,focus:function(r){return e.setFocusedField(e.FocusedField.Second)},blur:e.resetFocusedField},scopedSlots:e._u([{key:"balance",fn:function(){return[e._v("-")]},proxy:!0}])}),t("slippage-tolerance",{staticClass:"slippage-tolerance-settings"}),t("s-button",{staticClass:"action-button s-typography-button--large",attrs:{type:"primary","border-radius":"small",disabled:e.liquidityLocked||e.isEmptyAmount||e.isInsufficientBalance||e.isInsufficientXorForFee,loading:e.loading},on:{click:e.handleRemoveLiquidity}},[e.isEmptyAmount?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:e.isInsufficientBalance?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.t("removeLiquidity.liquidity")}))+" ")]:e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.XOR_SYMBOL}))+" ")]:[e._v(" "+e._s(e.t("removeLiquidity.remove"))+" ")]],2),e.price||e.priceReversed||e.networkFee||e.shareOfPool?t("remove-liquidity-transaction-details",{staticClass:"info-line-container",attrs:{"info-only":!1}}):e._e()],1),t("remove-liquidity-confirm",{attrs:{visible:e.confirmDialogVisibility,"parent-loading":e.parentLoading||e.loading},on:{"update:visible":function(r){e.confirmDialogVisibility=r},confirm:e.withdrawLiquidity}}),t("network-fee-warning-dialog",{attrs:{visible:e.showWarningFeeDialog,fee:e.formattedFee},on:{"update:visible":function(r){e.showWarningFeeDialog=r},confirm:e.confirmNetworkFeeWariningDialog}})],1)},I=[],O=w(o,S,I,!1,null,"1190b7eb");const E=O.exports;export{E as default};
