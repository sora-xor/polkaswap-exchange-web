var f=Object.defineProperty;var k=(s,t,e)=>t in s?f(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var d=(s,t,e)=>k(s,typeof t!="symbol"?t+"":t,e);import{m as v,$ as h,hY as i,b as a,P as b,W as g,C as p,l as F,j as S,_ as m,n as _}from"./index-BHqySXo4.js";import{S as w}from"./StakingMixin-CnPsAVWR.js";var x=Object.defineProperty,y=Object.getOwnPropertyDescriptor,u=(s,t,e,n)=>{for(var o=n>1?void 0:n?y(t,e):t,l=s.length-1,c;l>=0;l--)(c=s[l])&&(o=(n?c(t,e,o):c(o))||o);return n&&o&&x(t,e,o),o};let r=class extends v(w,h.TransactionMixin,h.DialogMixin){constructor(){super(...arguments);d(this,"mode");d(this,"StakeDialogMode",i);d(this,"value","");d(this,"bondAndNominateNetworkFee",null)}resetValue(){this.visible&&(this.mode===i.NEW?this.value=this.stakeAmount:this.value="")}handleSelectedValidatorsChange(){this.withApi(async()=>{this.bondAndNominateNetworkFee=await this.getBondAndNominateNetworkFee()})}get networkFee(){switch(this.mode){case i.NEW:return this.bondAndNominateNetworkFee??"0";case i.ADD:return this.networkFees[a.Operation.StakingBondExtra];default:return this.networkFees[a.Operation.StakingUnbond]}}get title(){switch(this.mode){case i.NEW:return this.t("soraStaking.actions.confirm");case i.ADD:return this.lockedFunds.isZero()?this.t("soraStaking.newStake.title"):this.t("soraStaking.actions.more");default:return this.t("soraStaking.actions.remove")}}get inputTitle(){return this.mode!==i.REMOVE?this.t("soraStaking.stakeDialog.toStake"):this.t("soraStaking.stakeDialog.toRemove")}get part(){return new a.FPNumber(this.value).div(a.FPNumber.HUNDRED)}get valueFunds(){return new a.FPNumber(this.value)}get valueFundsEmpty(){return this.valueFunds.isZero()}get stakingBalance(){return this.mode!==i.REMOVE?this.availableFunds:this.lockedFunds}get stakingBalanceCodec(){return this.stakingBalance.toCodecString()}get maxStake(){if(!this.stakingAsset)return a.FPNumber.ZERO;const e=a.FPNumber.fromCodecValue(this.networkFee);return this.mode!==i.REMOVE?this.stakingBalance.sub(e):this.stakingBalance}get isMaxButtonAvailable(){return this.shouldBalanceBeHidden?!1:!a.FPNumber.eq(this.valueFunds,this.maxStake)&&!a.FPNumber.lte(this.maxStake,a.FPNumber.ZERO)}get isInsufficientBalance(){var n;const e=new a.FPNumber(this.maxStake,(n=this.stakingAsset)==null?void 0:n.decimals);return a.FPNumber.lt(e,this.valueFunds)}get selectedValidatorsFormatted(){return this.t("soraStaking.selectedValidators",{count:this.selectedValidators.length,max:this.validators.length})}handleValue(e){this.value=String(e)}handleMaxValue(){this.handleValue(this.maxStake.toString())}async handleConfirm(){this.setStakeAmount(this.value);let e=this.unbond;this.mode===i.NEW?e=this.bondAndNominate:this.mode===i.ADD&&(e=this.bondExtra),await this.withNotifications(async()=>await e()),this.$emit("confirm")}async mounted(){await this.$nextTick();const e=this.$el.querySelector(".s-input .el-input__inner");e==null||e.focus()}};u([b({required:!0,type:String})],r.prototype,"mode",2);u([g("visible")],r.prototype,"resetValue",1);u([g("selectedValidators",{immediate:!0})],r.prototype,"handleSelectedValidatorsChange",1);r=u([p({components:{TokenInput:F(S.TokenInput),DialogBase:m.DialogBase,InfoLine:m.InfoLine,AccountCard:m.AccountCard}})],r);var N=function(){var n,o;var t=this,e=t._self._c;return t._self._setupProxy,e("dialog-base",{attrs:{visible:t.isVisible,title:t.title},on:{"update:visible":function(l){t.isVisible=l}}},[e("div",{staticClass:"stake-dialog"},[e("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[e("token-input",{key:"stake-input",attrs:{balance:t.stakingBalanceCodec,"is-max-available":t.isMaxButtonAvailable,title:t.inputTitle,token:t.stakingAsset,value:t.value},on:{input:t.handleValue,max:t.handleMaxValue}})],1),e("div",{staticClass:"info"},[t.mode===t.StakeDialogMode.NEW?e("info-line",{attrs:{label:t.t("soraStaking.info.selectedValidators"),value:t.selectedValidatorsFormatted}}):t._e(),t.mode===t.StakeDialogMode.NEW?e("info-line",{attrs:{label:t.t("soraStaking.info.rewardToken"),value:(n=t.rewardAsset)==null?void 0:n.symbol}}):t._e(),t.mode===t.StakeDialogMode.REMOVE?e("info-line",{attrs:{label:t.t("soraStaking.info.unstakingPeriod"),value:t.unbondPeriodFormatted}}):t._e(),e("info-line",{attrs:{label:t.t("networkFeeText"),"label-tooltip":t.t("networkFeeTooltipText"),value:t.networkFeeFormatted,"asset-symbol":(o=t.xor)==null?void 0:o.symbol,"fiat-value":t.getFiatAmountByCodecString(t.networkFee),"is-formatted":""}})],1),t.mode===t.StakeDialogMode.REMOVE?e("s-card",{staticClass:"information",attrs:{shadow:"always",primary:""}},[e("div",{staticClass:"information-content"},[e("div",{staticClass:"information-text"},[t._v(" "+t._s(t.t("soraStaking.allWithdrawsDialog.information"))+" ")]),e("div",{staticClass:"information-icon"},[e("s-icon",{attrs:{name:"notifications-alert-triangle-24",size:"20px"}})],1)])]):t._e(),t.stakingAsset?e("s-button",{staticClass:"s-typography-button--large action-button",attrs:{type:"primary",loading:t.parentLoading||t.loading,disabled:t.isInsufficientXorForFee||t.valueFundsEmpty||t.isInsufficientBalance},on:{click:t.handleConfirm}},[t.isInsufficientXorForFee||t.isInsufficientBalance?[t._v(" "+t._s(t.t("insufficientBalanceText",{tokenSymbol:t.stakingAsset.symbol}))+" ")]:t.valueFundsEmpty?[t._v(" "+t._s(t.t("buttons.enterAmount"))+" ")]:[t._v(" "+t._s(t.t("confirmText"))+" ")]],2):t._e()],1)])},C=[],D=_(r,N,C,!1,null,"07f4cffe");const P=D.exports;export{P as default};
