var m=Object.defineProperty;var A=(n,t,e)=>t in n?m(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var o=(n,t,e)=>A(n,typeof t!="symbol"?t+"":t,e);import{m as w,$ as p,f as y,F as d,Z as N,c as b,t as C,s as B,g as f,h as v,i as u,C as P,_ as h,n as k}from"./index-BHqySXo4.js";var U=Object.defineProperty,$=Object.getOwnPropertyDescriptor,l=(n,t,e,s)=>{for(var i=s>1?void 0:s?$(t,e):t,a=n.length-1,c;a>=0;a--)(c=n[a])&&(i=(s?c(t,e,i):c(i))||i);return s&&i&&U(t,e,i),i};let r=class extends w(p.TranslationMixin,p.LoadingMixin,p.NotificationMixin,p.FormattedAmountMixin){constructor(){super(...arguments);o(this,"alerts");o(this,"allowTopUpAlert");o(this,"isBrowserNotificationApiAvailable");o(this,"whitelistIdsBySymbol");o(this,"getAsset");o(this,"removePriceAlert");o(this,"setDepositNotifications");o(this,"setBrowserNotifsPopupEnabled");o(this,"setBrowserNotifsPopupBlocked");o(this,"scrollKey",0);o(this,"topUpNotifs",null)}get showCreateAlertBtn(){return this.alerts.length<y.MAX_ALERTS_NUMBER}isNotificationsEnabledByUser(){if(!this.isBrowserNotificationApiAvailable)return this.showAppNotification(this.t("alerts.noSupportMsg"),"error"),!1;switch(Notification.permission){case"denied":return this.setBrowserNotifsPopupBlocked(!0),!1;case"default":return this.setBrowserNotifsPopupEnabled(!0),!1;default:return!0}}getDescription(e){return e.type==="drop"?this.t("alerts.onDropDesc",{token:e.token,price:`$${e.price}`}):this.t("alerts.onRaiseDesc",{token:e.token,price:`$${e.price}`})}getInfo(e){const s=new d(e.price),i=this.getAsset(this.whitelistIdsBySymbol[e.token]),a=d.fromCodecValue(this.getAssetFiatPrice(i)??N),c=b(s,a),_=C(c,2).toString(),g=B(a);return`${_}% Â· ${this.t("alerts.currentPrice")}: $${g}`}forceCloseAlertMenu(e){var s,i,a;(a=(i=(s=this.$refs["alertMenu"+e])==null?void 0:s[0])==null?void 0:i.doClose)==null||a.call(i)}getType(e){return e.once?this.t("alerts.once"):this.t("alerts.always")}handleCreateAlert(){this.isNotificationsEnabledByUser()&&this.$emit("create")}scrollForceUpdate(){this.scrollKey++}handleDeleteAlert(e){this.removePriceAlert(e),this.forceCloseAlertMenu(e),this.scrollForceUpdate()}handleEditAlert(e,s){this.$emit("edit-alert",{...e,position:s}),this.forceCloseAlertMenu(s)}handleTopUpNotifs(e){this.isNotificationsEnabledByUser(),this.setDepositNotifications(e)}mounted(){Notification.permission!=="granted"&&this.setDepositNotifications(!1),this.topUpNotifs=this.allowTopUpAlert}};l([f.wallet.settings.alerts],r.prototype,"alerts",2);l([f.wallet.settings.allowTopUpAlert],r.prototype,"allowTopUpAlert",2);l([f.settings.isBrowserNotificationApiAvailable],r.prototype,"isBrowserNotificationApiAvailable",2);l([v.wallet.account.whitelistIdsBySymbol],r.prototype,"whitelistIdsBySymbol",2);l([v.assets.assetDataByAddress],r.prototype,"getAsset",2);l([u.wallet.settings.removePriceAlert],r.prototype,"removePriceAlert",2);l([u.wallet.settings.setDepositNotifications],r.prototype,"setDepositNotifications",2);l([u.settings.setBrowserNotifsPopupEnabled],r.prototype,"setBrowserNotifsPopupEnabled",2);l([u.settings.setBrowserNotifsPopupBlocked],r.prototype,"setBrowserNotifsPopupBlocked",2);r=l([P({components:{AccountCard:h.AccountCard,TokenLogo:h.TokenLogo}})],r);var D=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",[e("s-scrollbar",{key:t.scrollKey,staticClass:"alerts-list-scrollbar"},[e("div",{staticClass:"alerts-list"},t._l(t.alerts,function(s,i){return e("account-card",{directives:[{name:"button",rawName:"v-button"}],key:i,staticClass:"alerts-list__item",scopedSlots:t._u([{key:"avatar",fn:function(){return[e("token-logo",{attrs:{"token-symbol":s.token}})]},proxy:!0},{key:"name",fn:function(){return[e("span",{staticClass:"condition"},[t._v(t._s(t.getDescription(s)))])]},proxy:!0},{key:"description",fn:function(){return[e("span",{staticClass:"current-price"},[t._v(t._s(t.getInfo(s)))])]},proxy:!0}],null,!0)},[e("div",{staticClass:"alerts-list__type"},[t._v(t._s(t.getType(s)))]),e("el-popover",{ref:"alertMenu"+i,refInFor:!0,attrs:{"popper-class":"settings-alert-popover",trigger:"click","visible-arrow":!1}},[e("div",{directives:[{name:"button",rawName:"v-button"}],staticClass:"settings-alert-option",on:{click:function(a){return t.handleEditAlert(s,i)}}},[e("s-icon",{attrs:{name:"el-icon-edit"}}),e("span",[t._v(t._s(t.t("alerts.edit")))])],1),e("div",{directives:[{name:"button",rawName:"v-button"}],staticClass:"settings-alert-option",on:{click:function(a){return t.handleDeleteAlert(i)}}},[e("s-icon",{attrs:{name:"el-icon-delete"}}),e("span",[t._v(t._s(t.t("alerts.delete")))])],1),e("div",{attrs:{slot:"reference"},slot:"reference"},[e("s-icon",{staticClass:"options-icon",attrs:{name:"basic-more-vertical-24"}})],1)])],1)}),1)]),t.alerts.length?e("s-divider"):t._e(),t.showCreateAlertBtn?e("div",{staticClass:"settings-alert-section"},[e("s-button",{staticClass:"el-dialog__close",attrs:{type:"action",icon:"plus-16",disabled:t.loading},on:{click:t.handleCreateAlert}}),e("span",{staticClass:"create"},[t._v(t._s(t.t("alerts.createBtn")))])],1):t._e(),e("div",{staticClass:"settings-alert-section"},[e("s-switch",{attrs:{disabled:t.loading},on:{change:t.handleTopUpNotifs},model:{value:t.topUpNotifs,callback:function(s){t.topUpNotifs=s},expression:"topUpNotifs"}}),e("span",[t._v(t._s(t.t("alerts.enableSwitch")))])],1)],1)},M=[],T=k(r,D,M,!1,null,"4a4aca0b");const S=T.exports;export{S as default};
