var c=Object.defineProperty;var f=(i,e,t)=>e in i?c(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var l=(i,e,t)=>f(i,typeof e!="symbol"?e+"":e,t);import{m as F,$ as m,b as a,hk as h,Z as g,a3 as v,P as b,g as A,W as k,C as _,hz as S,hA as y,l as x,j as C,_ as p,n as P}from"./index-BHqySXo4.js";import{P as B}from"./PoolCardMixin-DMA33ZBw.js";import"./PoolStatusMixin-i2BweUOd.js";var w=Object.defineProperty,N=Object.getOwnPropertyDescriptor,r=(i,e,t,s)=>{for(var n=s>1?void 0:s?N(e,t):e,u=i.length-1,d;u>=0;u--)(d=i[u])&&(n=(s?d(e,t,n):d(n))||n);return s&&n&&w(e,t,n),n};let o=class extends F(B,m.DialogMixin,m.LoadingMixin){constructor(){super(...arguments);l(this,"isAdding");l(this,"shouldBalanceBeHidden");l(this,"value","")}resetValue(){this.value=""}get networkFee(){const t=this.isAdding?a.Operation.DemeterFarmingDepositLiquidity:a.Operation.DemeterFarmingWithdrawLiquidity;return this.networkFees[t]}get title(){const t=this.isAdding?this.hasStake?"add":"start":"remove";return this.t(`demeterFarming.actions.${t}`)}get inputTitle(){const t=this.isAdding?"amountAdd":"amountRemove";return this.t(`demeterFarming.${t}`)}get valuePartCharClass(){return`${{3:"three",2:"two"}[this.value.toString().length]??"one"}-char`}get part(){return new a.FPNumber(this.value).div(a.FPNumber.HUNDRED)}get poolShareAfter(){if(this.isAdding){const t=new a.FPNumber(this.depositFee),s=this.valueFunds.mul(t),n=this.lockedFunds.add(this.valueFunds.sub(s));return this.isFarm?n.div(this.funds.sub(s)).mul(a.FPNumber.HUNDRED):n}else{const t=a.FPNumber.max(this.lockedFunds,this.funds),s=a.FPNumber.max(this.lockedFunds.sub(this.valueFunds),a.FPNumber.ZERO);return this.isFarm?s.div(t).mul(a.FPNumber.HUNDRED):s}}get poolShareAfterFiat(){return this.isFarm||!this.poolAsset?null:this.getFiatAmountByFPNumber(this.poolShareAfter,this.poolAsset)}get poolShareAfterFormatted(){return this.poolShareAfter.toLocaleString()+(this.isFarm?"%":"")}get poolShareAfterText(){return this.isFarm?this.t("demeterFarming.info.poolShareWillBe"):this.t("demeterFarming.info.stakeWillBe",{symbol:this.poolAssetSymbol})}get valueFunds(){if(!this.poolAsset)return a.FPNumber.ZERO;if(!this.isFarm)return new a.FPNumber(this.value);if(this.isAdding){const t=a.FPNumber.fromCodecValue(this.networkFee);return(h(this.poolAsset)?this.availableFunds.sub(t):this.availableFunds).mul(this.part)}else return this.lockedFunds.mul(this.part)}get valueFundsEmpty(){return this.valueFunds.isZero()}get stakingBalance(){return this.isAdding?this.availableFunds:this.lockedFunds}get stakingBalanceCodec(){return this.stakingBalance.toCodecString()}get isMaxButtonAvailable(){if(this.shouldBalanceBeHidden||!this.poolAsset)return!1;const t=a.FPNumber.fromCodecValue(this.networkFee),s=this.isAdding&&h(this.poolAsset)?this.stakingBalance.sub(t):this.stakingBalance;return!a.FPNumber.eq(this.valueFunds,s)}get maxStake(){return this.poolAsset?this.isAdding?v(this.poolAsset,this.networkFee):this.lockedFunds.toString():g}get isInsufficientBalance(){var s;if(this.isFarm)return!1;const t=new a.FPNumber(this.maxStake,(s=this.poolAsset)==null?void 0:s.decimals);return a.FPNumber.lt(t,this.valueFunds)}handleValue(t){this.value=String(t)}handleMaxValue(){this.handleValue(this.maxStake)}handleConfirm(){const t={pool:this.pool,accountPool:this.accountPool,value:this.valueFunds},s=this.isAdding?"add":"remove";this.$emit(s,t)}};r([b({default:()=>!0,type:Boolean})],o.prototype,"isAdding",2);r([A.wallet.settings.shouldBalanceBeHidden],o.prototype,"shouldBalanceBeHidden",2);r([k("visible")],o.prototype,"resetValue",1);o=r([_({components:{DialogTitle:S(y.DialogTitle),TokenInput:x(C.TokenInput),DialogBase:p.DialogBase,InfoLine:p.InfoLine}})],o);var D=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("dialog-base",{attrs:{visible:e.isVisible,title:e.title},on:{"update:visible":function(s){e.isVisible=s}}},[t("div",{staticClass:"stake-dialog"},[t("dialog-title",{attrs:{"base-asset":e.baseAsset,"pool-asset":e.poolAsset,"is-farm":e.isFarm}}),e.isAdding?t("div",{staticClass:"stake-dialog-info"},[e.pricesAvailable?[t("info-line",{attrs:{label:e.TranslationConsts.APR,value:e.apr}}),t("info-line",{attrs:{label:e.t("demeterFarming.info.totalLiquidityLocked"),value:e.tvl}})]:e._e(),t("info-line",{attrs:{label:e.t("demeterFarming.info.rewardToken"),value:e.rewardAssetSymbol}})],2):e._e(),t("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[e.isFarm?t("s-float-input",{key:"farm-input",class:["s-input--stake-part",e.valuePartCharClass],attrs:{size:"medium",value:e.value,decimals:0,max:100},on:{input:e.handleValue}},[t("div",{staticClass:"input-title",attrs:{slot:"top"},slot:"top"},[e._v(e._s(e.inputTitle))]),t("div",{staticClass:"el-buttons el-buttons--between",attrs:{slot:"right"},slot:"right"},[t("span",{staticClass:"percent"},[e._v("%")]),e.isMaxButtonAvailable?t("s-button",{staticClass:"el-button--max s-typography-button--small",attrs:{type:"primary",alternative:"",size:"mini","border-radius":"mini"},on:{click:function(s){return s.stopPropagation(),e.handleValue(100)}}},[e._v(" "+e._s(e.t("buttons.max"))+" ")]):e._e()],1),t("s-slider",{staticClass:"slider-container",attrs:{slot:"bottom",value:Number(e.value),"show-tooltip":!1},on:{input:e.handleValue},slot:"bottom"})],1):t("token-input",{key:"stake-input",attrs:{balance:e.stakingBalanceCodec,"is-max-available":e.isMaxButtonAvailable,title:e.inputTitle,token:e.poolAsset,value:e.value},on:{input:e.handleValue,max:e.handleMaxValue}})],1),e.hasStake?t("info-line",{attrs:{"value-can-be-hidden":"",label:e.poolShareText,value:e.poolShareFormatted,"fiat-value":e.poolShareFiat}}):e._e(),t("info-line",{attrs:{"value-can-be-hidden":"",label:e.poolShareAfterText,value:e.poolShareAfterFormatted,"fiat-value":e.poolShareAfterFiat}}),e.isAdding?t("info-line",{attrs:{label:e.t("demeterFarming.info.fee"),"label-tooltip":e.t("demeterFarming.info.feeTooltip"),value:e.depositFeeFormatted}}):e._e(),t("info-line",{attrs:{label:e.t("networkFeeText"),"label-tooltip":e.t("networkFeeTooltipText"),value:e.networkFeeFormatted,"asset-symbol":e.xorSymbol,"fiat-value":e.getFiatAmountByCodecString(e.networkFee),"is-formatted":""}}),t("s-button",{staticClass:"s-typography-button--large action-button",attrs:{type:"primary",loading:e.parentLoading,disabled:e.isInsufficientXorForFee||e.valueFundsEmpty||e.isInsufficientBalance},on:{click:e.handleConfirm}},[e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.xorSymbol}))+" ")]:e.isInsufficientBalance?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.poolAssetSymbol}))+" ")]:e.valueFundsEmpty?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:[e._v(" "+e._s(e.t("confirmText"))+" ")]],2)],1)])},T=[],V=P(o,D,T,!1,null,"db834397");const R=V.exports;export{R as default};
