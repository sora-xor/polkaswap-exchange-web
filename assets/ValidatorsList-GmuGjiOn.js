var b=Object.defineProperty;var g=(i,t,s)=>t in i?b(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var o=(i,t,s)=>g(i,typeof t!="symbol"?t+"":t,s);import{m as _,$ as V,az as n,h_ as y,hZ as S,P as k,W as x,C as L,l as w,j as N,_ as f,hJ as p,hK as v,n as I}from"./index-BHqySXo4.js";import{S as M}from"./StakingMixin-CnPsAVWR.js";import{V as z}from"./ValidatorsMixin-BFrWW90m.js";var R=Object.defineProperty,E=Object.getOwnPropertyDescriptor,m=(i,t,s,e)=>{for(var a=e>1?void 0:e?E(t,s):t,r=i.length-1,c;r>=0;r--)(c=i[r])&&(a=(e?c(t,s,a):c(a))||a);return e&&a&&R(t,s,a),a};function l(i,t,s,e){return{[i]:!0,[`${i}--active`]:t===s||t===e,[`${i}--asc`]:t===s,[`${i}--desc`]:t===e}}let d=class extends _(M,z,V.LoadingMixin){constructor(){super(...arguments);o(this,"mode");o(this,"ValidatorsListMode",n);o(this,"search","");o(this,"sort","return-desc")}get isValidatorModeRecommended(){return this.mode===n.RECOMMENDED}get sortedValidators(){return[...this.validators].sort((s,e)=>{switch(this.sort){case"commission-asc":return Number(s.commission)-Number(e.commission);case"commission-desc":return Number(e.commission)-Number(s.commission);case"return-asc":return Number(s.apy)-Number(e.apy);case"return-desc":return Number(e.apy)-Number(s.apy);default:throw new Error("Invalid sort type")}})}get filteredValidators(){const s=this.filterValidators(this.sortedValidators,this.validatorsFilter,this.search);switch(this.mode){case n.RECOMMENDED:return this.filterValidators(this.sortedValidators,y,"").slice(0,this.maxNominations);case n.USER:return s.filter(e=>{var a;return(a=this.stakingInfo)==null?void 0:a.myValidators.includes(e.address)});default:return s}}get emptyText(){var s;return this.mode===n.USER&&((s=this.stakingInfo)==null?void 0:s.myValidators.length)===0?this.t("soraStaking.validatorsList.noNominatedValidators"):this.t("soraStaking.validatorsList.noValidators")}get commissionHeaderClass(){return l("table-header-commission",this.sort,"commission-asc","commission-desc")}get returnHeaderClass(){return l("table-header-return",this.sort,"return-asc","return-desc")}get commissionClass(){return l("info-commission",this.sort,"commission-asc","commission-desc")}get returnClass(){return l("info-return",this.sort,"return-asc","return-desc")}filterValidators(s,e,a=""){return s.filter(r=>e.hasIdentity&&(!r.identity||!Object.keys(r.identity.info).length)||e.notSlashed&&r.blocked||e.notOversubscribed&&r.isOversubscribed||e.twoValidatorsPerIdentity&&r.isOversubscribed&&s.filter(C=>{var u,h;return((u=C.identity)==null?void 0:u.info.display)===((h=r.identity)==null?void 0:h.info.display)}).length>2?!1:this.decodeName(r).toLowerCase().includes(a.toLowerCase()))}setCommissionSort(){switch(this.sort){case"commission-asc":this.sort="commission-desc";break;case"commission-desc":this.sort="commission-asc";break;default:this.sort="commission-asc"}}setReturnSort(){switch(this.sort){case"return-asc":this.sort="return-desc";break;case"return-desc":this.sort="return-asc";break;default:this.sort="return-asc"}}toggleSelectValidator(s){if(this.isValidatorModeRecommended)return;const e=this.selectedValidators.findIndex(r=>r.address===s.address),a=[...this.selectedValidators];e>-1?a.splice(e,1):a.push(s),this.$emit("update:selected",a)}isSelected(s){return this.selectedValidators.some(e=>e.address===s.address)}getValidatorAvatar(s){var e,a;return(e=s.identity)!=null&&e.info.image?(a=s.identity)==null?void 0:a.info.image:"/staking/validator-avatar.svg"}onValidatorsChange(){this.$emit("update:selected",this.isValidatorModeRecommended?this.filteredValidators:[])}openFilters(){this.setShowValidatorsFilterDialog(!0)}created(){this.setValidatorsFilter(S)}};m([k({required:!0,type:String})],d.prototype,"mode",2);m([x("validators",{immediate:!0})],d.prototype,"onValidatorsChange",1);d=m([L({components:{TokenInput:w(N.TokenInput),InfoLine:f.InfoLine,FormattedAddress:f.FormattedAddress,StakingHeader:p(v.StakingHeader),ValidatorAvatar:p(v.ValidatorAvatar)}})],d);var F=function(){var t=this,s=t._self._c;return t._self._setupProxy,s("div",{staticClass:"validators"},[t.isValidatorModeRecommended?t._e():s("div",{staticClass:"search-container"},[s("s-input",{attrs:{type:"text",placeholder:t.t("soraStaking.validatorsList.search"),prefix:"s-icon-basic-search-24"},scopedSlots:t._u([{key:"right",fn:function(){return[s("s-button",{staticClass:"filters-button",attrs:{type:"outline",size:"mini"},on:{click:t.openFilters}},[s("div",{staticClass:"filters-button-content"},[s("span",[t._v(t._s(t.t("soraStaking.validatorsFilterDialog.title")))]),s("s-icon",{attrs:{name:"basic-settings-24",size:"14px"}})],1)])]},proxy:!0}],null,!1,3445169883),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),s("div",{staticClass:"table-header"},[s("div",{staticClass:"table-header-avatar table-header-item"},[s("s-icon",{attrs:{name:"various-bone-24",size:"14px"}})],1),s("div",{staticClass:"table-header-name table-header-item"},[t._v(t._s(t.t("soraStaking.validatorsList.name")))]),s("div",{staticClass:"table-header-info table-header-item"},[s("div",{directives:[{name:"button",rawName:"v-button"}],class:t.commissionHeaderClass,on:{click:t.setCommissionSort}},[s("span",[t._v(t._s(t.t("soraStaking.validatorsList.commission")))]),s("s-tooltip",{attrs:{"border-radius":"mini",content:t.t("soraStaking.validatorsList.commissionTooltip")}},[s("s-icon",{attrs:{name:"info-16",size:"14px"}})],1),s("s-icon",{staticClass:"chevron",attrs:{name:"arrows-chevron-top-rounded-24",size:"18"}})],1),s("div",{directives:[{name:"button",rawName:"v-button"}],class:t.returnHeaderClass,on:{click:t.setReturnSort}},[s("span",[t._v(t._s(t.t("soraStaking.validatorsList.return")))]),s("s-tooltip",{attrs:{"border-radius":"mini",content:t.t("comingSoonText")}},[s("s-icon",{attrs:{name:"info-16",size:"14px"}})],1),s("s-icon",{staticClass:"chevron",attrs:{name:"arrows-chevron-top-rounded-24",size:"18"}})],1)])]),s("div",{staticClass:"list"},[t.filteredValidators.length?s("s-scrollbar",{staticClass:"validators-list-scrollbar"},[s("ul",{staticClass:"list"},t._l(t.filteredValidators,function(e){return s("li",{key:e.address,staticClass:"validator"},[s("validator-avatar",{staticClass:"avatar",attrs:{validator:e}},[t.isSelected(e)?s("div",{staticClass:"check",attrs:{slot:"icon"},slot:"icon"},[s("s-icon",{attrs:{name:"basic-check-mark-24",size:"12px"}})],1):t._e()]),s("div",{staticClass:"name-and-address"},[s("div",{staticClass:"name"},[t._v(" "+t._s(t.formatName(e))+" ")]),s("formatted-address",{attrs:{value:e.address,symbols:16}})],1),s("div",{staticClass:"info"},[s("span",{class:t.commissionClass},[t._v(t._s(t.formatCommission(e.commission))+"%")]),s("br"),s("span",{class:t.returnClass},[t._v(t._s(t.formatReturn(e.apy))+"%")])]),t.mode===t.ValidatorsListMode.SELECT?s("div",{directives:[{name:"button",rawName:"v-button"}],staticClass:"select-area",on:{click:function(a){return t.toggleSelectValidator(e)}}}):t._e()],1)}),0)]):s("div",{staticClass:"empty"},[s("span",[t._v(t._s(t.emptyText))])])],1),s("div",{staticClass:"blackout"})])},O=[],$=I(d,F,O,!1,null,"82b33579");const W=$.exports;export{W as default};
