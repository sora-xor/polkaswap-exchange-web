var x=Object.defineProperty;var _=(n,e,t)=>e in n?x(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var i=(n,e,t)=>_(n,typeof e!="symbol"?e+"":e,t);import{m as v,$ as h,b as a,X as b,ai as w,o as g,Y as k,Z as d,ak as B,a3 as N,a4 as P,g as p,h as y,i as F,C,l as f,j as c,_ as I,n as A}from"./index-BHqySXo4.js";import{C as X}from"./ConfirmDialogMixin-BYoYOPfg.js";var D=Object.defineProperty,R=Object.getOwnPropertyDescriptor,m=(n,e,t,o)=>{for(var r=o>1?void 0:o?R(e,t):e,l=n.length-1,u;l>=0;l--)(u=n[l])&&(r=(o?u(e,t,r):u(r))||r);return o&&r&&D(e,t,r),r};let s=class extends v(h.FormattedAmountMixin,h.TransactionMixin,X){constructor(){super(...arguments);i(this,"networkFees");i(this,"amount");i(this,"xor");i(this,"setAmount");i(this,"resetAmount");i(this,"delimiters",a.FPNumber.DELIMITERS_CONFIG)}get xorSymbol(){return b.symbol}get xorDecimals(){return b.decimals}get xorBalance(){var t;return(t=this.xor)==null?void 0:t.balance}get balance(){return w(this.xor,{isBondedBalance:this.isBondedBalance})}get isBond(){return this.$route.name===g.ReferralBonding}get isBondedBalance(){return!this.isBond}get hasZeroAmount(){return k(this.amount)}get isMaxButtonAvailable(){var r,l;if(this.shouldBalanceBeHidden)return!1;const t=this.getFPNumberFromCodec(((r=this.xorBalance)==null?void 0:r.transferable)??d,this.xorDecimals),o=this.getFPNumber(this.amount,this.xorDecimals);if(this.fpNumberNetworkFee.isZero())return!1;if(this.isBondedBalance){const u=((l=this.xorBalance)==null?void 0:l.bonded)??d;return!this.getFPNumberFromCodec(u,this.xorDecimals).isZero()&&a.FPNumber.gt(t,this.fpNumberNetworkFee)}return!a.FPNumber.eq(this.fpNumberNetworkFee,t.sub(o))&&a.FPNumber.gt(t,this.fpNumberNetworkFee)}get isInsufficientBondedXor(){return!!this.xor&&B(this.xor,this.amount,this.networkFee,{isBondedBalance:this.isBondedBalance})}get isInsufficientXorForFee(){var t;return this.isBondedBalance?a.FPNumber.gt(this.fpNumberNetworkFee,this.getFPNumberFromCodec(((t=this.xorBalance)==null?void 0:t.transferable)??d,this.xorDecimals)):!!this.xor&&B(this.xor,this.amount,this.networkFee)}get networkFee(){return this.networkFees[this.isBond?a.Operation.ReferralReserveXor:a.Operation.ReferralUnreserveXor]}get fpNumberNetworkFee(){return this.getFPNumberFromCodec(this.networkFee)}get networkFeeFormatted(){return this.formatCodecNumber(this.networkFee)}get isConfirmBondDisabled(){return this.hasZeroAmount||this.isInsufficientXorForFee||this.isInsufficientBondedXor}handleInputXor(t){t!==this.amount&&this.setAmount(t)}handleMaxValue(){const{xor:t,networkFee:o,isBondedBalance:r}=this;t&&this.handleInputXor(N(t,o,{isBondedBalance:r}))}handleConfirmBond(){this.confirmOrExecute(this.confirmBond)}async confirmBond(){await this.withNotifications(async()=>{await(this.isBond?a.api.referralSystem.reserveXor(this.amount):a.api.referralSystem.unreserveXor(this.amount)),this.resetAmount(),this.handleBack()})}handleBack(){P.push({name:g.ReferralProgram})}destroyed(){this.resetAmount()}};m([p.wallet.settings.networkFees],s.prototype,"networkFees",2);m([p.referrals.amount],s.prototype,"amount",2);m([y.assets.xor],s.prototype,"xor",2);m([F.referrals.setAmount],s.prototype,"setAmount",2);m([F.referrals.resetAmount],s.prototype,"resetAmount",2);s=m([C({components:{GenericPageHeader:f(c.GenericPageHeader),TokenInput:f(c.TokenInput),ReferralsConfirmBonding:f(c.ReferralsConfirmBonding),InfoLine:I.InfoLine}})],s);var T=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.parentLoading,expression:"parentLoading"}],staticClass:"container"},[t("generic-page-header",{attrs:{"has-button-back":"",title:e.t(e.isBond?"referralProgram.bondTitle":"referralProgram.unbondTitle")},on:{back:e.handleBack}}),t("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[t("token-input",{attrs:{balance:e.balance,"is-max-available":e.isMaxButtonAvailable,title:e.t(e.isBond?"referralProgram.action.bond":"referralProgram.action.unbond"),token:e.xor,value:e.amount},on:{input:e.handleInputXor,max:e.handleMaxValue}}),t("s-button",{staticClass:"action-button s-typography-button--large",attrs:{type:"primary",disabled:e.isConfirmBondDisabled,loading:e.loading},on:{click:e.handleConfirmBond}},[e.hasZeroAmount?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.xorSymbol}))+" ")]:e.isBondedBalance&&e.isInsufficientBondedXor?[e._v(" "+e._s(e.t("referralProgram.insufficientBondedBalance"))+" ")]:[e._v(" "+e._s(e.t(e.isBond?"referralProgram.action.bond":"referralProgram.action.unbond"))+" ")]],2),t("info-line",{attrs:{label:e.t("networkFeeText"),"label-tooltip":e.t("networkFeeTooltipText"),value:e.networkFeeFormatted,"asset-symbol":e.xorSymbol,"fiat-value":e.getFiatAmountByCodecString(e.networkFee),"is-formatted":""}}),t("referrals-confirm-bonding",{attrs:{visible:e.confirmDialogVisibility},on:{"update:visible":function(o){e.confirmDialogVisibility=o},confirm:e.confirmBond}})],1)],1)},Z=[],M=A(s,T,Z,!1,null,"eee75bfd");const j=M.exports;export{j as default};
