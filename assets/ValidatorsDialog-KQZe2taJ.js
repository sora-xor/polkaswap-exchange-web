var k=Object.defineProperty;var M=(o,t,e)=>t in o?k(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var n=(o,t,e)=>M(o,typeof t!="symbol"?t+"":t,e);import{m as E,$ as m,az as s,i as p,k as u,W as S,C as v,_ as f,hJ as c,hK as g,n as b}from"./index-BHqySXo4.js";import{S as C}from"./StakingMixin-CnPsAVWR.js";var y=Object.defineProperty,_=Object.getOwnPropertyDescriptor,d=(o,t,e,a)=>{for(var i=a>1?void 0:a?_(t,e):t,l=o.length-1,h;l>=0;l--)(h=o[l])&&(i=(a?h(t,e,i):h(i))||i);return a&&i&&y(t,e,i),i};let r=class extends E(C,m.DialogMixin,m.TransactionMixin){constructor(){super(...arguments);n(this,"setStakingInfo");n(this,"getStakingInfo");n(this,"getNominateNetworkFee");n(this,"ValidatorsListMode",s);n(this,"mode",s.USER);n(this,"isSelectingEditingMode",!1);n(this,"nominateNetworkFee",null)}async handleSelectedValidatorsChange(){this.withApi(async()=>{this.nominateNetworkFee=await this.getNominateNetworkFee()})}resetMode(){this.visible&&(this.setMode(s.USER),this.selectValidators([]))}get networkFee(){return this.nominateNetworkFee??"0"}get title(){return this.hasTabs?this.t("soraStaking.info.validators"):this.t("soraStaking.validatorsDialog.title.edit")}get hasBackButton(){return this.isEditMode||this.isSelectingEditingMode}get isEditMode(){return[s.RECOMMENDED,s.SELECT].includes(this.mode)}get hasTabs(){return this.tabs.includes(this.mode)}get tabs(){return[s.USER,s.ALL]}get hasChanges(){var i;const e=this.selectedValidators.map(l=>l.address),a=(i=this.stakingInfo)==null?void 0:i.myValidators;return a?!(e.every(l=>a.includes(l))&&e.length===a.length):!1}get tooManySelected(){return this.selectedValidators.length>this.maxNominations}get confirmText(){var e,a;switch(this.mode){case s.USER:return this.t("soraStaking.validators.change");case s.RECOMMENDED:return this.isInsufficientXorForFee?this.t("insufficientBalanceText",{tokenSymbol:((e=this.xor)==null?void 0:e.symbol)??""}):this.hasChanges?this.t("soraStaking.validators.save"):this.t("soraStaking.validators.alreadyNominated");case s.SELECT:return this.isInsufficientXorForFee?this.t("insufficientBalanceText",{tokenSymbol:((a=this.xor)==null?void 0:a.symbol)??""}):this.hasChanges?this.tooManySelected?this.t("soraStaking.validators.tooManyValidators"):this.t("soraStaking.validators.selected",{selected:this.selectedValidators.length,total:this.validators.length}):this.t("soraStaking.validators.alreadyNominated");default:return""}}get showConfirmButton(){return this.mode!==s.ALL&&!this.isSelectingEditingMode}get confirmDisabled(){return this.isInsufficientXorForFee&&this.mode!==s.USER?!0:this.mode===s.RECOMMENDED?!this.hasChanges:this.mode===s.SELECT?this.selectedValidators.length===0||!this.hasChanges||this.tooManySelected:!1}handleBack(){this.isSelectingEditingMode?this.setMode(s.USER):this.isSelectingEditingMode=!0}async handleConfirm(){this.mode===s.USER?this.isSelectingEditingMode=!0:await this.withNotifications(async()=>{if(await this.nominate(),!this.stakingInfo)throw new Error("There is no staking info");this.setStakingInfo({...this.stakingInfo,myValidators:this.selectedValidators.map(e=>e.address)}),this.mode=s.USER})}setMode(e){this.mode=e,this.isSelectingEditingMode=!1}handleRecommendedMode(){this.setMode(s.RECOMMENDED)}handleSelectedMode(){this.setMode(s.SELECT)}};d([p.staking.setStakingInfo],r.prototype,"setStakingInfo",2);d([u.staking.getStakingInfo],r.prototype,"getStakingInfo",2);d([u.staking.getNominateNetworkFee],r.prototype,"getNominateNetworkFee",2);d([S("selectedValidators")],r.prototype,"handleSelectedValidatorsChange",1);d([S("visible")],r.prototype,"resetMode",1);r=d([v({components:{DialogBase:f.DialogBase,StakingHeader:c(g.StakingHeader),ValidatorsList:c(g.ValidatorsList),SelectValidatorsMode:c(g.SelectValidatorsMode),InfoLine:f.InfoLine}})],r);var V=function(){var a;var t=this,e=t._self._c;return t._self._setupProxy,e("dialog-base",{staticClass:"validators-dialog",attrs:{visible:t.isVisible},on:{"update:visible":function(i){t.isVisible=i}}},[e("staking-header",{staticClass:"header",attrs:{"has-back-button":t.hasBackButton},on:{back:t.handleBack}},[t._v(" "+t._s(t.title)+" ")]),t.isSelectingEditingMode?e("select-validators-mode",{on:{recommended:t.handleRecommendedMode,selected:t.handleSelectedMode}}):e("div",{staticClass:"content"},[t.hasTabs?e("s-tabs",{staticClass:"tabs",attrs:{type:"rounded"},model:{value:t.mode,callback:function(i){t.mode=i},expression:"mode"}},t._l(t.tabs,function(i){return e("s-tab",{key:i,attrs:{label:t.t(`soraStaking.validatorsDialog.tabs.${i}`),name:i}})}),1):t._e(),e("validators-list",{attrs:{mode:t.mode},on:{"update:selected":t.selectValidators}}),t.showConfirmButton?e("div",{staticClass:"bottom"},[e("s-button",{staticClass:"confirm",attrs:{type:"primary",loading:t.parentLoading||t.loading,disabled:t.confirmDisabled},on:{click:t.handleConfirm}},[t._v(" "+t._s(t.confirmText)+" ")]),t.isEditMode?e("div",{staticClass:"info"},[e("info-line",{attrs:{label:t.t("networkFeeText"),"label-tooltip":t.t("networkFeeTooltipText"),value:t.networkFeeFormatted,"asset-symbol":(a=t.xor)==null?void 0:a.symbol,"fiat-value":t.getFiatAmountByCodecString(t.networkFee),"is-formatted":""}})],1):t._e()],1):t._e()],1)],1)},w=[],F=b(r,V,w,!1,null,"1a75c4aa");const L=F.exports;export{L as default};
