var k=Object.defineProperty;var S=(r,e,t)=>e in r?k(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>S(r,typeof e!="symbol"?e+"":e,t);import{m as x,$ as p,hU as D,aJ as P,b as h,W as v,C as A,l as I,j as L,hJ as N,hK as T,_ as u,n as V}from"./index-BHqySXo4.js";import{S as z}from"./StakingMixin-CnPsAVWR.js";import{V as $}from"./ValidatorsMixin-BFrWW90m.js";var O=Object.defineProperty,B=Object.getOwnPropertyDescriptor,m=(r,e,t,a)=>{for(var i=a>1?void 0:a?B(e,t):e,s=r.length-1,n;s>=0;s--)(n=r[s])&&(i=(a?n(e,t,i):n(i))||i);return a&&i&&O(e,t,i),i};let o=class extends x(z,$,p.TransactionMixin,p.DialogMixin){constructor(){super(...arguments);c(this,"payoutNetworkFee",null);c(this,"selectedRewards",[])}resetValue(){this.visible&&(this.selectedRewards=[])}async handlePendingRewardsChange(){this.payoutNetworkFee=await this.getPayoutNetworkFee({payouts:this.payouts})}get networkFee(){return this.payoutNetworkFee??"0"}get title(){return this.t("soraStaking.pendingRewardsDialog.title")}get rewards(){return!this.pendingRewards||!this.rewardAsset?[]:this.pendingRewards.map(a=>a.validators.map(i=>{var w,f,g;const s=this.validators.find(F=>F.address===i.address);if(!s)throw new Error(`There is no validator "${i.address}" in the list`);const n=this.formatName(s),y=((this.historyDepth??0)-(this.currentEra-Number(a.era)))*D,d=Math.floor(y/24),_=d<1?"less then 1 day left":d+" days left",R=d<5,l=i.value,C=P(new h.FPNumber(l,(w=this.rewardAsset)==null?void 0:w.decimals))+" "+((f=this.rewardAsset)==null?void 0:f.symbol),b=this.getFiatAmountByFPNumber(new h.FPNumber(l,(g=this.rewardAsset)==null?void 0:g.decimals),this.rewardAsset??void 0);return{id:`${i.address}-${a.era}`,era:a.era,validators:a.validators,name:n,daysLeft:d,daysLeftFormatted:_,alert:R,value:l,valueFormatted:C,valueFiat:b,validator:s}})).flat()}isRewardSelected(t){return this.selectedRewards.some(a=>a.id===t.id)}toggleRewardSelection(t){const a=this.selectedRewards.findIndex(s=>s.id===t.id),i=[...this.selectedRewards];a>-1?i.splice(a,1):i.push(t),this.selectedRewards=i}computedClassDaysLeft(t){const a=["days-left"];return t&&a.push("days-left--alert"),a.join(" ")}get noReward(){return!this.rewards.length}get noSelectedRewards(){return!this.selectedRewards.length}get payouts(){return this.selectedRewards.map(t=>({era:t.era,validators:t.validators.map(a=>a.address)}))}async handleConfirm(){await this.withNotifications(async()=>{await this.payout({payouts:this.payouts}),await this.getPendingRewards(),this.closeDialog()})}};m([v("visible",{immediate:!0})],o.prototype,"resetValue",1);m([v("selectedRewards")],o.prototype,"handlePendingRewardsChange",1);o=m([A({components:{TokenInput:I(L.TokenInput),ValidatorAvatar:N(T.ValidatorAvatar),DialogBase:u.DialogBase,InfoLine:u.InfoLine,FormattedAmount:u.FormattedAmount}})],o);var M=function(){var a,i;var e=this,t=e._self._c;return e._self._setupProxy,t("dialog-base",{attrs:{visible:e.isVisible,title:e.title},on:{"update:visible":function(s){e.isVisible=s}}},[t("div",{staticClass:"pending-rewards-dialog"},[t("s-scrollbar",{staticClass:"pending-rewards-scrollbar"},[t("s-card",{staticClass:"information",attrs:{shadow:"always",primary:""}},[t("div",{staticClass:"information-content"},[t("div",{staticClass:"information-text"},[e._v(" "+e._s(e.t("soraStaking.pendingRewardsDialog.information"))+" ")]),t("div",{staticClass:"information-icon"},[t("s-icon",{attrs:{name:"notifications-alert-triangle-24",size:"20px"}})],1)])]),e._l(e.rewards,function(s){return t("s-card",{key:s.id,staticClass:"reward",attrs:{"border-radius":"medium",shadow:"always",size:"mini"},nativeOn:{click:function(n){return e.toggleRewardSelection(s)}}},[t("div",{staticClass:"reward-content"},[t("validator-avatar",{staticClass:"avatar",attrs:{validator:s.validator}},[s.alert?t("s-icon",{staticClass:"alert-icon",attrs:{slot:"icon",name:"notifications-alert-triangle-24",size:"16px"},slot:"icon"}):e._e()],1),t("div",{staticClass:"reward-lines"},[t("div",{staticClass:"reward-line"},[t("div",{staticClass:"name"},[e._v(" "+e._s(s.name)+" ")]),t("div",{staticClass:"value"},[e._v(" "+e._s(s.valueFormatted)+" ")])]),t("div",{staticClass:"reward-line"},[t("div",{class:e.computedClassDaysLeft(s.alert)},[e._v(" "+e._s(s.daysLeftFormatted)+" ")]),t("formatted-amount",{staticClass:"value-fiat",attrs:{"is-fiat-value":"","with-left-shift":"",value:s.valueFiat}})],1)]),t("div",{class:{"reward-check":!0,"reward-check--selected":e.isRewardSelected(s)}},[t("s-icon",{attrs:{name:"basic-check-mark-24",size:"18px"}})],1)],1)])})],2),t("div",{staticClass:"info"},[t("info-line",{attrs:{label:e.t("networkFeeText"),"label-tooltip":e.t("networkFeeTooltipText"),value:e.networkFeeFormatted,"asset-symbol":(a=e.xor)==null?void 0:a.symbol,"fiat-value":e.getFiatAmountByCodecString(e.networkFee),"is-formatted":""}})],1),t("s-button",{staticClass:"s-typography-button--large action-button",attrs:{type:"primary",loading:e.parentLoading||e.loading,disabled:e.isInsufficientXorForFee||e.noReward||e.noSelectedRewards},on:{click:e.handleConfirm}},[e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:(i=e.stakingAsset)==null?void 0:i.symbol}))+" ")]:e.noReward?[e._v(e._s(e.t("soraStaking.pendingRewardsDialog.noPendingRewards")))]:e.noSelectedRewards?[e._v(e._s(e.t("soraStaking.pendingRewardsDialog.noSelectedRewards")))]:[e._v(e._s(e.t("soraStaking.pendingRewardsDialog.payout"))+" ("+e._s(e.selectedRewards.length)+")")]],2)],1)])},j=[],E=V(o,M,j,!1,null,"4d06dcfe");const K=E.exports;export{K as default};
