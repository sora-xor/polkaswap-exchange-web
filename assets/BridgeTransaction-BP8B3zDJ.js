var y=Object.defineProperty;var v=(l,t,e)=>t in l?y(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var o=(l,t,e)=>v(l,typeof t!="symbol"?t+"":t,e);import{m as b,$ as f,gw as w,hl as F,N as I,Z as m,A as N,ak as _,aj as A,a2 as B,a4 as S,g as u,h as p,k as T,i as E,C,l as x,j as g,_ as k,n as L}from"./index-BHqySXo4.js";import{B as P}from"./BridgeMixin-B7wtyjiP.js";import{B as H}from"./BridgeTransactionMixin-C_ITN4YO.js";import{N as D}from"./NetworkFormatterMixin-DdB_9in4.js";import"./WalletConnectMixin-CatA0t7p.js";var O=Object.defineProperty,R=Object.getOwnPropertyDescriptor,h=(l,t,e,i)=>{for(var s=i>1?void 0:i?R(t,e):t,a=l.length-1,n;a>=0;a--)(n=l[a])&&(s=(i?n(t,e,s):n(s))||s);return i&&s&&O(t,e,s),s};const V=24;let r=class extends b(f.FormattedAmountMixin,f.CopyAddressMixin,P,H,D){constructor(){super(...arguments);o(this,"KnownSymbols",w);o(this,"externalBlockNumber");o(this,"waitingForApprove");o(this,"inProgressIds");o(this,"prevRoute");o(this,"historyItem");o(this,"externalAccount");o(this,"removeHistory");o(this,"handleBridgeTransaction");o(this,"setHistoryId")}get tx(){return this.historyItem}get txIsUnsigned(){var e;return(e=this.historyItem)!=null&&e.id?F(this.historyItem):!1}get hasRetry(){return this.isTxFailed?this.txIsUnsigned||this.isEvmTxType:!1}get txInProcess(){var e;return(e=this.historyItem)!=null&&e.id?this.historyItem.id in this.inProgressIds:!1}get txWaitingForApprove(){var e;return(e=this.historyItem)!=null&&e.id?this.historyItem.id in this.waitingForApprove:!1}get amount(){var e;return((e=this.historyItem)==null?void 0:e.amount)??""}get amountReceived(){var e;return((e=this.historyItem)==null?void 0:e.amount2)??this.amount}get amountFiatValue(){return this.asset?this.getFiatAmountByString(this.amount,this.asset):null}get amountReceivedFiatValue(){return this.asset?this.getFiatAmountByString(this.amountReceived,this.asset):null}get formattedAmount(){return this.amount&&this.asset?this.formatStringValue(this.amount,this.asset.decimals):""}get formattedAmountReceived(){return this.amountReceived&&this.asset?this.formatStringValue(this.amountReceived,this.asset.decimals):""}get assetSymbol(){var e;return((e=this.asset)==null?void 0:e.symbol)??""}get parachainNetworkId(){try{return I.getSoraParachain(this.externalNetworkId)}catch{return null}}get txSoraNetworkFee(){var e;return((e=this.historyItem)==null?void 0:e.soraNetworkFee)??this.soraNetworkFee}get txSoraNetworkFeeFormatted(){var e;return this.formatCodecNumber(this.txSoraNetworkFee,(e=this.xor)==null?void 0:e.decimals)}get txSoraNetworkFeeFiatValue(){return this.getFiatAmountByCodecString(this.txSoraNetworkFee)}get txExternalNetworkFee(){var e;return((e=this.historyItem)==null?void 0:e.externalNetworkFee)??this.externalNetworkFee}get txExternalNetworkFeeFormatted(){return this.formatCodecNumber(this.txExternalNetworkFee,this.nativeTokenDecimals)}get txExternalNetworkFeeApproximation(){var e;return this.txExternalNetworkFeeFormatted===m?!1:!((e=this.historyItem)!=null&&e.externalNetworkFee)}get txExternalNetworkFeeFiatValue(){return this.nativeToken?this.getFiatAmountByCodecString(this.txExternalNetworkFee,this.nativeToken):null}get txExternalTransferFee(){var e;return((e=this.historyItem)==null?void 0:e.externalTransferFee)??m}get txExternalTransferFeeFormatted(){var e;return this.formatCodecNumber(this.txExternalTransferFee,(e=this.asset)==null?void 0:e.externalDecimals)}get txExternalTransferFeeNotZero(){return this.txExternalTransferFee!==m}get txExternalTransferFeeFiatValue(){return this.asset?this.getFiatAmountByCodecString(this.txExternalTransferFee,this.asset):null}get txParachainBlockId(){var e;return((e=this.historyItem)==null?void 0:e.parachainBlockId)??""}get txParachainBlockNumber(){var e;return(e=this.historyItem)==null?void 0:e.parachainBlockHeight}get txDate(){return this.formatDatetime(this.historyItem)}get txState(){var e;return((e=this.historyItem)==null?void 0:e.transactionState)??N.Pending}get isTxFailed(){return this.isFailedState(this.historyItem)}get isTxCompleted(){return this.isSuccessState(this.historyItem)}get isTxWaiting(){return this.isWaitingForAction(this.historyItem)}get isTxPending(){return!this.isTxFailed&&!this.isTxCompleted}get txIsFinilized(){return!this.isTxPending&&!this.isTxWaiting&&!this.hasRetry}get headerIconClasses(){const e="header-icon",i=[e];return this.isTxWaiting?i.push(`${e}--wait`):this.isTxFailed?i.push(`${e}--error`):this.isTxCompleted?i.push(`${e}--success`):i.push(`${e}--wait`),i.join(" ")}get transactionStatus(){return this.txIsUnsigned||this.isTxWaiting?this.t("bridgeTransaction.statuses.waitingForConfirmation"):this.isTxFailed?this.t("bridgeTransaction.statuses.failed"):this.isTxCompleted?this.t("bridgeTransaction.statuses.done"):this.t("bridgeTransaction.statuses.pending")+"..."}get isGreaterThanMaxAmount(){return this.txIsUnsigned&&this.isGreaterThanTransferMaxAmount(this.amount,this.asset,this.isOutgoing)}get isLowerThanMinAmount(){return this.txIsUnsigned&&this.isLowerThanTransferMinAmount(this.amount,this.asset,this.isOutgoing)}get isInsufficientBalance(){const e=this.isOutgoing?this.txSoraNetworkFee:this.txExternalNetworkFee;return!this.asset||!this.amount||!e?!1:this.txIsUnsigned&&_(this.asset,this.amount,e,{isExternalBalance:!this.isOutgoing,isExternalNative:this.isNativeTokenSelected})}get isInsufficientXorForFee(){return this.txIsUnsigned&&A(this.xor,this.txSoraNetworkFee)}get isInsufficientEvmNativeTokenForFee(){return(this.txIsUnsigned&&!this.isOutgoing||!this.txIsUnsigned&&this.isOutgoing)&&B(this.externalNativeBalance,this.txExternalNetworkFee)}get isAnotherEvmAddress(){return this.isEvmTxType?this.txExternalAccount.toLowerCase()!==this.externalAccount.toLowerCase():!1}get confirmationButtonDisabled(){return!(this.isOutgoing||this.isValidNetwork)||this.isAnotherEvmAddress||this.isInsufficientBalance||this.isGreaterThanMaxAmount||this.isLowerThanMinAmount||this.isInsufficientXorForFee||this.isInsufficientEvmNativeTokenForFee||this.isTxPending}get externalNetworkName(){return this.externalNetworkType&&this.externalNetworkId?this.getNetworkName(this.externalNetworkType,this.externalNetworkId):""}get parachainExplorerLinks(){return this.externalNetworkType&&this.parachainNetworkId?this.getNetworkExplorerLinks(this.externalNetworkType,this.parachainNetworkId,"",this.txParachainBlockNumber):[]}async created(){if(!this.historyItem){this.navigateToBridge();return}await this.withParentLoading(async()=>{const e=!this.txInProcess&&this.isTxPending;await this.handleTransaction(e)})}beforeDestroy(){if(!this.txInProcess&&this.txIsUnsigned){const e={...this.historyItem};this.removeHistory({tx:e,force:!0})}this.setHistoryId()}get confirmationBlocksLeft(){if(!(this.isEvmTxType&&!this.isOutgoing&&this.txExternalBlockNumber&&this.externalBlockNumber))return 0;const e=this.txExternalBlockNumber+30-this.externalBlockNumber;return Math.max(e,0)}get failedClass(){return this.isTxFailed&&!this.isTxWaiting?"info-line--error":""}async handleTransaction(e=!0){var i;e&&((i=this.historyItem)!=null&&i.id)&&await this.handleBridgeTransaction(this.historyItem.id)}handleBack(){S.push({name:this.prevRoute})}get txInternalHash(){return this.isOutgoing?this.txSoraHash||this.txInternalBlockId||this.txSoraId:this.txSoraHash}get accountLinks(){const e=this.t("accountAddressText"),i=this.getLinkData(this.txInternalAccount,this.internalAccountLinks,e),s=this.getLinkData(this.txExternalAccount,this.externalAccountLinks,e,this.externalNetworkId);return this.sortLinksByTxDirection([i,s])}get transactionLinks(){const e=this.t("bridgeTransaction.transactionHash"),i=this.t("transaction.blockId"),s=this.getLinkData(this.txInternalHash,this.internalExplorerLinks,e),a=this.getLinkData(this.txParachainBlockId,this.parachainExplorerLinks,i,this.parachainNetworkId),n=this.getLinkData(this.txExternalHash??this.txExternalBlockId,this.externalExplorerLinks,this.txExternalHash?e:i,this.externalNetworkId);return this.sortLinksByTxDirection([s,a,n])}sortLinksByTxDirection(e){const i=e.filter(s=>!!s);return this.isOutgoing?i:[...i].reverse()}getLinkData(e,i,s,a){if(!e)return null;const n=this.getNetworkText(s,a);return{value:e,formatted:this.formatAddress(e,V),placeholder:n,tooltip:this.copyTooltip(n),links:i}}};h([u.bridge.externalBlockNumber],r.prototype,"externalBlockNumber",2);h([u.bridge.waitingForApprove],r.prototype,"waitingForApprove",2);h([u.bridge.inProgressIds],r.prototype,"inProgressIds",2);h([u.router.prev],r.prototype,"prevRoute",2);h([p.bridge.historyItem],r.prototype,"historyItem",2);h([p.bridge.externalAccount],r.prototype,"externalAccount",2);h([T.bridge.removeHistory],r.prototype,"removeHistory",2);h([T.bridge.handleBridgeTransaction],r.prototype,"handleBridgeTransaction",2);h([E.bridge.setHistoryId],r.prototype,"setHistoryId",2);r=h([C({components:{GenericPageHeader:x(g.GenericPageHeader),ConfirmBridgeTransactionDialog:x(g.ConfirmBridgeTransactionDialog),LinksDropdown:x(g.LinksDropdown),FormattedAmount:k.FormattedAmount,InfoLine:k.InfoLine}})],r);var M=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"container transaction-container"},[e("generic-page-header",{attrs:{"has-button-back":"",title:t.t("bridgeTransaction.title")},on:{back:t.handleBack}},[e("s-button",{staticClass:"el-button--history",attrs:{type:"action",icon:"time-time-history-24",tooltip:t.t("bridgeHistory.showHistory"),"tooltip-placement":"bottom-end"},on:{click:t.handleViewTransactionsHistory}})],1),e("div",{staticClass:"transaction-content"},[e("div",{staticClass:"header"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isTxPending,expression:"isTxPending"}],class:t.headerIconClasses}),e("h5",{staticClass:"header-details"},[e("formatted-amount",{staticClass:"info-line-value",attrs:{"value-can-be-hidden":"",value:t.formattedAmount,"asset-symbol":t.assetSymbol}},[e("i",{class:`network-icon network-icon--${t.getNetworkIcon(t.isOutgoing?0:t.externalNetworkId)}`})]),e("span",{staticClass:"header-details-separator"},[t._v(t._s(t.t("bridgeTransaction.for")))]),e("formatted-amount",{staticClass:"info-line-value",attrs:{"value-can-be-hidden":"",value:t.formattedAmountReceived,"asset-symbol":t.assetSymbol}},[e("i",{class:`network-icon network-icon--${t.getNetworkIcon(t.isOutgoing?t.externalNetworkId:0)}`})])],1)]),t._l(t.accountLinks,function({value:i,formatted:s,placeholder:a,tooltip:n,links:c}){return e("div",{key:i,staticClass:"transaction-hash-container transaction-hash-container--with-dropdown"},[e("s-input",{attrs:{placeholder:a,value:s,readonly:""}}),e("s-button",{staticClass:"s-button--hash-copy",attrs:{type:"action",alternative:"",icon:"basic-copy-24",tooltip:n},on:{click:function(d){return t.handleCopyAddress(i,d)}}}),c.length?e("links-dropdown",{attrs:{links:c}}):t._e()],1)}),e("info-line",{class:t.failedClass,attrs:{label:t.t("bridgeTransaction.networkInfo.status"),value:t.transactionStatus}}),e("info-line",{attrs:{label:t.t("bridgeTransaction.networkInfo.date"),value:t.txDate}}),t.amount?e("info-line",{attrs:{"is-formatted":"","value-can-be-hidden":"",label:t.t("bridgeTransaction.networkInfo.amount"),value:t.formattedAmount,"asset-symbol":t.assetSymbol,"fiat-value":t.amountFiatValue}}):t._e(),t.amountReceived?e("info-line",{attrs:{"is-formatted":"","value-can-be-hidden":"",label:t.t("receivedText"),value:t.formattedAmountReceived,"asset-symbol":t.assetSymbol,"fiat-value":t.amountReceivedFiatValue}}):t._e(),e("info-line",{attrs:{"is-formatted":"",label:t.getNetworkText(t.t("bridgeTransaction.networkInfo.transactionFee")),value:t.txSoraNetworkFeeFormatted,"asset-symbol":t.KnownSymbols.XOR,"fiat-value":t.txSoraNetworkFeeFiatValue}}),e("info-line",{attrs:{"is-formatted":"",label:t.getNetworkText(t.t("bridgeTransaction.networkInfo.transactionFee"),t.externalNetworkId,t.txExternalNetworkFeeApproximation),value:t.txExternalNetworkFeeFormatted,"asset-symbol":t.nativeTokenSymbol,"fiat-value":t.txExternalNetworkFeeFiatValue}}),t.txExternalTransferFeeNotZero?e("info-line",{attrs:{"is-formatted":"",label:t.t("bridge.externalTransferFee",{network:t.externalNetworkName}),value:t.txExternalTransferFeeFormatted,"asset-symbol":t.assetSymbol,"fiat-value":t.txExternalTransferFeeFiatValue}}):t._e(),t._l(t.transactionLinks,function({value:i,formatted:s,placeholder:a,tooltip:n,links:c}){return e("div",{key:i,staticClass:"transaction-hash-container transaction-hash-container--with-dropdown"},[e("s-input",{attrs:{placeholder:a,value:s,readonly:""}}),e("s-button",{staticClass:"s-button--hash-copy",attrs:{type:"action",alternative:"",icon:"basic-copy-24",tooltip:n},on:{click:function(d){return t.handleCopyAddress(i,d)}}}),c.length?e("links-dropdown",{attrs:{links:c}}):t._e()],1)}),t.txIsFinilized?t._e():[t.isAnotherEvmAddress?e("s-button",{attrs:{type:"primary"},on:{click:t.connectEvmWallet}},[t.externalAccount?[t._v(" "+t._s(t.t("changeAccountText"))+" ")]:[t._v(" "+t._s(t.t("connectWalletText"))+" ")]],2):e("s-button",{staticClass:"s-typograhy-button--big",attrs:{type:"primary",disabled:t.confirmationButtonDisabled},on:{click:t.handleTransaction}},[t.confirmationBlocksLeft?[t._v(" "+t._s(t.t("bridgeTransaction.blocksLeft",{count:t.confirmationBlocksLeft}))+" ")]:t.txWaitingForApprove?[t._v(t._s(t.t("bridgeTransaction.allowToken",{tokenSymbol:t.assetSymbol})))]:t.isTxPending?[t._v(t._s(t.t("bridgeTransaction.pending")))]:t.isOutgoing||t.isValidNetwork?t.isInsufficientBalance?[t._v(t._s(t.t("insufficientBalanceText",{tokenSymbol:t.assetSymbol})))]:t.isInsufficientXorForFee?[t._v(t._s(t.t("insufficientBalanceText",{tokenSymbol:t.KnownSymbols.XOR})))]:t.isInsufficientEvmNativeTokenForFee?[t._v(t._s(t.t("insufficientBalanceText",{tokenSymbol:t.nativeTokenSymbol})))]:t.isGreaterThanMaxAmount?[t._v(" "+t._s(t.t("exceededAmountText",{amount:t.t("maxAmountText")}))+" ")]:t.isLowerThanMinAmount?[t._v(" "+t._s(t.t("exceededAmountText",{amount:t.t("minAmountText")}))+" ")]:t.isTxWaiting?[t._v(t._s(t.t("confirmTransactionText")))]:t.hasRetry?[t._v(t._s(t.t("retryText")))]:t._e():[t._v(t._s(t.t("changeNetworkText")))]],2),t.txWaitingForApprove?e("div",{staticClass:"transaction-approval-text"},[t._v(" "+t._s(t.t("bridgeTransaction.approveToken"))+" ")]):t._e()]],2),t.txIsFinilized?e("s-button",{staticClass:"s-typography-button--large",attrs:{type:"secondary"},on:{click:t.navigateToBridge}},[t._v(" "+t._s(t.t("bridgeTransaction.newTransaction"))+" ")]):t._e()],1)},W=[],U=L(r,M,W,!1,null,"89043e10");const q=U.exports;export{q as default};
