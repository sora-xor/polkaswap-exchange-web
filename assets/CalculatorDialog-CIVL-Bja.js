var A=Object.defineProperty;var F=(l,e,t)=>e in l?A(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var r=(l,e,t)=>F(l,typeof e!="symbol"?e+"":e,t);import{m as P,$ as c,L as f,b as s,ai as g,am as d,aJ as v,a3 as h,P as w,W as V,C as D,hz as C,hA as _,l as N,j as x,_ as b,n as B}from"./index-BHqySXo4.js";import{P as k}from"./PoolCardMixin-DMA33ZBw.js";import"./PoolStatusMixin-i2BweUOd.js";var R=Object.defineProperty,y=Object.getOwnPropertyDescriptor,m=(l,e,t,a)=>{for(var i=a>1?void 0:a?y(e,t):e,o=l.length-1,n;o>=0;o--)(n=l[o])&&(i=(a?n(e,t,i):n(i))||i);return a&&i&&R(e,t,i),i};let u=class extends P(k,c.DialogMixin,c.LoadingMixin){constructor(){super(...arguments);r(this,"emission");r(this,"baseAssetValue","");r(this,"poolAssetValue","");r(this,"intervals",[1,7,30,90]);r(this,"interval",1);r(this,"link",f.demeterFarmingPlatform)}resetValue(){this.baseAssetValue="",this.poolAssetValue=""}get networkFee(){return this.networkFees[s.Operation.DemeterFarmingDepositLiquidity]}get selectedPeriod(){return String(this.interval)}get rewardsText(){return this.t("demeterFarming.rewards",{symbol:this.rewardAssetSymbol})}get baseAssetDecimals(){var t;return((t=this.baseAsset)==null?void 0:t.decimals)??s.FPNumber.DEFAULT_PRECISION}get baseAssetBalance(){return this.baseAsset?s.FPNumber.fromCodecValue(g(this.baseAsset)??0,this.baseAssetDecimals):s.FPNumber.ZERO}get isBaseAssetMaxButtonAvailable(){return this.baseAsset?d(this.baseAsset,this.baseAssetValue,this.networkFee,this.xor):!1}get isPoolAssetMaxButtonAvailable(){return this.poolAsset?d(this.poolAsset,this.poolAssetValue,this.networkFee,this.xor):!1}get userTokensDeposit(){var t;return this.isFarm?this.lpBalance.mul(new s.FPNumber(this.poolAssetValue||0)).div(s.FPNumber.fromCodecValue(((t=this.liquidity)==null?void 0:t.secondBalance)??0)):new s.FPNumber(this.poolAssetValue||0)}get userTokensDepositWithFee(){const t=new s.FPNumber(this.depositFee);return this.userTokensDeposit.mul(s.FPNumber.ONE.sub(t))}get calculatedRewards(){if(!this.pool)return s.FPNumber.ZERO;const t=this.pool.totalTokensInPool.add(this.userTokensDepositWithFee);if(t.isZero())return s.FPNumber.ZERO;const a=new s.FPNumber(this.interval),i=new s.FPNumber(14400),o=a.mul(i);return this.emission.mul(o).mul(this.userTokensDepositWithFee).div(t)}get calculatedRewardsFormatted(){return this.calculatedRewards.toLocaleString()}get calculatedRewardsFiat(){return this.rewardAsset?this.getFiatAmountByFPNumber(this.calculatedRewards,this.rewardAsset):null}get calculatedRoiPercent(){const t=new s.FPNumber(this.poolAssetValue||0);if(t.isZero()||this.poolAssetPrice.isZero())return s.FPNumber.ZERO;const a=this.isFarm?2:1,i=t.mul(new s.FPNumber(a)).mul(this.poolAssetPrice),o=i.mul(new s.FPNumber(this.depositFee)),n=s.FPNumber.fromCodecValue(this.networkFee).mul(s.FPNumber.fromCodecValue(this.getAssetFiatPrice(this.xor)??0)),p=o.add(n);return this.calculatedRewards.mul(this.rewardAssetPrice).sub(p).div(i).mul(s.FPNumber.HUNDRED)}get calculatedRoiPercentFormatted(){return v(this.calculatedRoiPercent,!0)}selectPeriod(t){this.interval=Number(t)}handleBaseAssetValue(t){var a,i;this.baseAssetValue=t,t?this.liquidity&&(this.poolAssetValue=new s.FPNumber(this.baseAssetValue).mul(s.FPNumber.fromCodecValue(((a=this.liquidity)==null?void 0:a.secondBalance)??0)).div(s.FPNumber.fromCodecValue(((i=this.liquidity)==null?void 0:i.firstBalance)??0)).toString()):this.poolAssetValue=""}handlePoolAssetValue(t){var a,i;this.poolAssetValue=t,t?this.liquidity&&(this.baseAssetValue=new s.FPNumber(this.poolAssetValue).mul(s.FPNumber.fromCodecValue(((a=this.liquidity)==null?void 0:a.firstBalance)??0)).div(s.FPNumber.fromCodecValue(((i=this.liquidity)==null?void 0:i.secondBalance)??0)).toString()):this.baseAssetValue=""}handleBaseAssetMax(){this.baseAsset&&this.handleBaseAssetValue(h(this.baseAsset,this.networkFee))}handlePoolAssetMax(){this.poolAsset&&this.handlePoolAssetValue(h(this.poolAsset,this.networkFee))}};m([w({default:()=>s.FPNumber.ZERO,type:Object})],u.prototype,"emission",2);m([V("visible")],u.prototype,"resetValue",1);u=m([D({components:{DialogTitle:C(_.DialogTitle),TokenInput:N(x.TokenInput),DialogBase:b.DialogBase,InfoLine:b.InfoLine}})],u);var O=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("dialog-base",{attrs:{visible:e.isVisible,title:`${e.TranslationConsts.APR} ${e.t("demeterFarming.calculator")}`},on:{"update:visible":function(a){e.isVisible=a}}},[t("div",{staticClass:"calculator-dialog"},[t("dialog-title",{attrs:{"base-asset":e.baseAsset,"pool-asset":e.poolAsset,"is-farm":e.isFarm}}),t("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[e.isFarm&&e.baseAsset?[t("token-input",{attrs:{balance:e.baseAssetBalance.toCodecString(),"is-max-available":e.isBaseAssetMaxButtonAvailable,title:e.t("demeterFarming.amountAdd"),token:e.baseAsset,value:e.baseAssetValue},on:{input:e.handleBaseAssetValue,max:e.handleBaseAssetMax}}),e.poolAsset?t("s-icon",{staticClass:"icon-divider",attrs:{name:"plus-16"}}):e._e()]:e._e(),e.poolAsset?t("token-input",{attrs:{balance:e.poolAssetBalance.toCodecString(),"is-max-available":e.isPoolAssetMaxButtonAvailable,title:e.t("demeterFarming.amountAdd"),token:e.poolAsset,value:e.poolAssetValue},on:{input:e.handlePoolAssetValue,max:e.handlePoolAssetMax}}):e._e()],2),t("div",{staticClass:"duration"},[t("info-line",{staticClass:"duration-title",attrs:{label:"Duration"}}),t("s-tabs",{staticClass:"duration-tabs",attrs:{type:"rounded",value:e.selectedPeriod},on:{input:e.selectPeriod}},e._l(e.intervals,function(a){return t("s-tab",{key:a,attrs:{name:String(a),label:`${a}D`}})}),1)],1),t("div",{staticClass:"results"},[t("div",{staticClass:"results-title"},[e._v(e._s(e.TranslationConsts.APR)+" "+e._s(e.t("demeterFarming.results")))]),t("info-line",{attrs:{label:e.TranslationConsts.ROI,"label-tooltip":e.t("tooltips.roi"),value:e.calculatedRoiPercentFormatted}}),t("info-line",{attrs:{label:e.rewardsText,value:e.calculatedRewardsFormatted,"fiat-value":e.calculatedRewardsFiat}})],1),t("a",{staticClass:"demeter-copyright",attrs:{href:e.link,target:"_blank",rel:"nofollow noopener"}},[e._v(" "+e._s(e.t("demeterFarming.poweredBy"))+" ")])],1)])},S=[],T=B(u,O,S,!1,null,"3e83277e");const Z=T.exports;export{Z as default};
