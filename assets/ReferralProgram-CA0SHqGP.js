var k=Object.defineProperty;var R=(n,e,r)=>e in n?k(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r;var s=(n,e,r)=>R(n,typeof e!="symbol"?e+"":e,r);import{m as _,$ as d,a5 as L,f as A,X as C,Z as g,b as m,hq as P,hr as w,aH as B,h0 as U,hs as x,a4 as v,o as b,g as l,h as y,i as c,k as u,W as S,C as F,_ as f,ht as I,n as M}from"./index-BHqySXo4.js";var T=Object.defineProperty,O=Object.getOwnPropertyDescriptor,i=(n,e,r,t)=>{for(var o=t>1?void 0:t?O(e,r):e,p=n.length-1,h;p>=0;p--)(h=n[p])&&(o=(t?h(e,r,o):h(o))||o);return t&&o&&T(e,r,o),o};let a=class extends _(d.LoadingMixin,d.FormattedAmountMixin,d.PaginationSearchMixin,d.NetworkFeeWarningMixin,d.CopyAddressMixin,L){constructor(){super(...arguments);s(this,"WALLET_CONSTS",A);s(this,"referrerLinkOrCode","");s(this,"referrerHasApproved",!1);s(this,"pageAmount",5);s(this,"referralRewards");s(this,"invitedUsers");s(this,"referrer");s(this,"isReferrerApproved");s(this,"isTMA");s(this,"telegramBotUrl");s(this,"xor");s(this,"account");s(this,"reset");s(this,"unsubscribeFromInvitedUsers");s(this,"resetReferrerSubscription");s(this,"setStorageReferrer");s(this,"subscribeOnInvitedUsers");s(this,"getReferrer");s(this,"getAccountReferralRewards");s(this,"subscribeOnReferrer")}updateSubscriptions(r){r?this.initData():(this.unsubscribeFromInvitedUsers(),this.resetReferrerSubscription())}async initData(){this.isLoggedIn&&(await this.subscribeOnInvitedUsers(),await this.getAccountReferralRewards(),await this.getReferrer(),await this.subscribeOnReferrer())}get isPriceAvailable(){return!!this.getAssetFiatPrice(C)}get xorSymbol(){return C.symbol}get formattedRewards(){var r;return((r=this.referralRewards)==null?void 0:r.rewards.toLocaleString())??g}get formattedRewardsFiatValue(){var r;return(r=this.referralRewards)!=null&&r.rewards?this.getFiatAmountByFPNumber(this.referralRewards.rewards):null}get invitedUserRewards(){var r;return((r=this.referralRewards)==null?void 0:r.invitedUserRewards)??{}}get bondedXorCodecBalance(){var r,t;return((t=(r=this.xor)==null?void 0:r.balance)==null?void 0:t.bonded)??""}get inviteUserFee(){return this.formatCodecNumber(this.networkFees.ReferralSetInvitedUser)}get isInsufficientBondedAmount(){return this.bondedXorCodecBalance?m.FPNumber.gt(this.getFPNumberFromCodec(this.networkFees.ReferralSetInvitedUser),this.getFPNumberFromCodec(this.bondedXorCodecBalance)):!1}get formattedBondedXorBalance(){return this.bondedXorCodecBalance?this.formatCodecNumber(this.bondedXorCodecBalance):g}get formattedBondedXorFiatValue(){return this.bondedXorCodecBalance?this.getFiatAmountByCodecString(this.bondedXorCodecBalance):null}get invitedUsersCount(){return this.invitedUsers.length}get invitedUsersClasses(){const r="invited-users-list",t=[r];return this.hasMultipleInvitedUsersPages&&t.push(`${r}--multiple-pages`),t}get linkHrefBase(){return`${P(v)}referral/`}get referralLink(){return{href:`${this.linkHrefBase}${this.account.address}`,label:this.getLinkLabel(this.account.address)}}get hasAccountWithBondedXor(){return this.account&&+this.bondedXorCodecBalance>0}get bondedContainerClasses(){const r="bonded-container",t=[r];return this.hasAccountWithBondedXor||(t.push("is-active"),t.push(`${r}--visible-content`)),t}get isReferrerLinkEmpty(){return!this.referrerLinkOrCode.trim()}get referrerFormatted(){return this.referrer?w(this.referrer,8):""}get referrerAddress(){return this.referrer?this.referrer:B(this.referrerLinkOrCode.split("/"))??""}get isValidReferrerLink(){var r;return this.isReferrerLinkEmpty||!m.api.validateAddress(this.referrerAddress)||m.api.formatAddress(this.referrerAddress)===((r=this.account)==null?void 0:r.address)?!1:this.referrerLinkOrCode===this.referrerAddress?!0:this.referrerLinkOrCode===this.referrerLink.href}get filteredInvitedUsers(){return this.getPageItems(this.invitedUsers)}get hasMultipleInvitedUsersPages(){return this.invitedUsers.length>this.pageAmount}get referrerLink(){return{href:`${this.linkHrefBase}${this.referrerAddress}`,label:this.getLinkLabel(this.referrerAddress)}}get bondButtonType(){return this.hasAccountWithBondedXor?"secondary":"primary"}get hasTMALink(){return this.isTMA&&!!this.telegramBotUrl}get refLinkTooltip(){return this.hasTMALink?this.t("referralProgram.inviteViaTelegram"):this.copyTooltip(this.t("referralProgram.invitationLink"))}get refLinkText(){return this.hasTMALink?this.t("referralProgram.action.shareLink"):this.t("referralProgram.action.copyLink")}handleClickRefLink(r){if(!this.hasTMALink){this.handleCopyAddress(this.referralLink.href,r);return}const t=`${this.telegramBotUrl}/app?startapp=${this.account.address}`;U.shareLink(t,this.t("referralProgram.welcomeMessage"))}destroyed(){this.reset()}created(){this.withApi(async()=>{await this.initData()})}getLinkLabel(r){return`<span class="referral-link-address">Polkaswap.io/</span>${x(v)}referral/${r}`}getInvitedUserReward(r){const t=this.invitedUserRewards[r];return typeof r=="string"&&t?this.formatCodecNumber(t.toCodecString()):g}handleBonding(r=!1){v.push({name:r?b.ReferralBonding:b.ReferralUnbonding})}handleSetReferrer(){this.setStorageReferrer(this.referrerAddress)}};i([l.referrals.referralRewards],a.prototype,"referralRewards",2);i([l.referrals.invitedUsers],a.prototype,"invitedUsers",2);i([l.referrals.referrer],a.prototype,"referrer",2);i([l.referrals.isReferrerApproved],a.prototype,"isReferrerApproved",2);i([l.settings.isTMA],a.prototype,"isTMA",2);i([l.settings.telegramBotUrl],a.prototype,"telegramBotUrl",2);i([y.assets.xor],a.prototype,"xor",2);i([y.wallet.account.account],a.prototype,"account",2);i([c.referrals.reset],a.prototype,"reset",2);i([c.referrals.unsubscribeFromInvitedUsers],a.prototype,"unsubscribeFromInvitedUsers",2);i([c.referrals.resetReferrerSubscription],a.prototype,"resetReferrerSubscription",2);i([c.referrals.setStorageReferrer],a.prototype,"setStorageReferrer",2);i([u.referrals.subscribeOnInvitedUsers],a.prototype,"subscribeOnInvitedUsers",2);i([u.referrals.getReferrer],a.prototype,"getReferrer",2);i([u.referrals.getAccountReferralRewards],a.prototype,"getAccountReferralRewards",2);i([u.referrals.subscribeOnReferrer],a.prototype,"subscribeOnReferrer",2);i([S("isLoggedIn")],a.prototype,"updateSubscriptions",1);a=i([F({components:{FormattedAmount:f.FormattedAmount,FormattedAddress:f.FormattedAddress,InfoLine:f.InfoLine,ReferralBonding:I(b.ReferralBonding),WalletAvatar:f.WalletAvatar,TokenLogo:f.TokenLogo}})],a);var X=function(){var e=this,r=e._self._c;return e._self._setupProxy,r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"referral-program"},[e.isLoggedIn?[r("div",{staticClass:"rewards-container"},[r("span",{staticClass:"rewards-title"},[e._v(e._s(e.t("referralProgram.receivedRewards")))]),r("token-logo",{attrs:{token:e.xor,size:e.WALLET_CONSTS.LogoSize.BIGGER}}),r("formatted-amount",{staticClass:"rewards-value",attrs:{"value-can-be-hidden":"","font-size-rate":e.FontSizeRate.SMALL,"symbol-as-decimal":"",value:e.formattedRewards,"asset-symbol":e.xorSymbol}}),e.formattedRewardsFiatValue?r("formatted-amount",{attrs:{"is-fiat-value":"","fiat-default-rounding":"","value-can-be-hidden":"","font-size-rate":e.FontSizeRate.MEDIUM,value:e.formattedRewardsFiatValue,"is-formatted":""}}):e._e()],1),e.hasAccountWithBondedXor?[e.isInsufficientBondedAmount?r("div",{staticClass:"referral-insufficient-bonded-amount"},[e._v(" "+e._s(e.t("referralProgram.insufficientBondedAmount",{inviteUserFee:e.inviteUserFee}))+" ")]):r("s-card",{staticClass:"referral-link-container",attrs:{shadow:"always",size:"small","border-radius":"medium"}},[r("div",{staticClass:"referral-link-details with-text"},[r("div",{staticClass:"referral-link-label"},[e._v(e._s(e.t("referralProgram.invitationLink")))]),r("div",{staticClass:"referral-link",domProps:{innerHTML:e._s(e.referralLink.label)}})]),r("s-button",{staticClass:"s-typography-button--mini",attrs:{size:"small",type:"primary",tooltip:e.refLinkTooltip},on:{click:function(t){return e.handleClickRefLink(t)}}},[e._v(" "+e._s(e.refLinkText)+" "),r("s-icon",{attrs:{name:"copy-16",size:"16"}})],1)],1)]:e._e(),r("s-collapse",{attrs:{borders:!0}},[r("s-collapse-item",{class:e.bondedContainerClasses,attrs:{disabled:!e.hasAccountWithBondedXor,name:"bondedXOR"},scopedSlots:e._u([e.hasAccountWithBondedXor?{key:"title",fn:function(){return[r("token-logo",{attrs:{token:e.xor}}),r("h3",{staticClass:"bonded-collapse-title"},[e._v(e._s(e.t("referralProgram.bondedXOR")))])]},proxy:!0}:null],null,!0)},[e.hasAccountWithBondedXor?e._e():r("div",{staticClass:"unbonded-info"},[r("token-logo",{attrs:{token:e.xor}}),r("p",{staticClass:"referral-program-hint referral-program-hint--connected",domProps:{innerHTML:e._s(e.t("referralProgram.startInviting"))}})],1),r("info-line",{attrs:{"is-formatted":"","value-can-be-hidden":"",label:e.t("referralProgram.bondedXOR"),value:e.formattedBondedXorBalance,"fiat-value":e.formattedBondedXorFiatValue}}),r("div",{staticClass:"bonded--buttons"},[r("s-button",{staticClass:"s-typography-button--medium",attrs:{type:e.bondButtonType},on:{click:function(t){return e.handleBonding(!0)}}},[e._v(" "+e._s(e.t("referralProgram.action.bondMore"))+" ")]),e.hasAccountWithBondedXor?r("s-button",{staticClass:"s-typography-button--medium",attrs:{type:"secondary"},on:{click:function(t){return e.handleBonding()}}},[e._v(" "+e._s(e.t("referralProgram.action.unbond"))+" ")]):e._e()],1)],1),e.invitedUsersCount?r("s-collapse-item",{staticClass:"invited-users-container",attrs:{name:"invitedUsers"},scopedSlots:e._u([{key:"title",fn:function(){return[r("span",{staticClass:"invited-users-icon"}),r("h3",{staticClass:"invited-users-collapse-title"},[e._v(" "+e._s(e.t("referralProgram.referralsNumber",{number:e.invitedUsersCount}))+" ")])]},proxy:!0}],null,!1,1546159244)},[e.invitedUsersCount?[r("div",{class:e.invitedUsersClasses},e._l(e.filteredInvitedUsers,function(t){return r("info-line",{key:t,attrs:{"value-can-be-hidden":"",value:e.getInvitedUserReward(t),"asset-symbol":e.xorSymbol,"is-formatted":""},scopedSlots:e._u([{key:"info-line-prefix",fn:function(){return[r("formatted-address",{attrs:{value:t,"tooltip-text":e.t("transaction.referral")}})]},proxy:!0}],null,!0)})}),1),e.hasMultipleInvitedUsersPages?r("s-pagination",{attrs:{layout:"total, prev, next","current-page":e.currentPage,"page-size":e.pageAmount,total:e.invitedUsersCount},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"prev-click":e.handlePrevClick,"next-click":e.handleNextClick}}):e._e()]:e._e()],2):e._e(),r("s-collapse-item",{staticClass:"referrer-link-container",attrs:{name:"referrer"},scopedSlots:e._u([{key:"title",fn:function(){return[e.referrer?r("WalletAvatar",{staticClass:"referrer-icon",attrs:{size:32,address:e.referrer}}):e._e(),r("h3",{staticClass:"referrer-collapse-title"},[e._v(" "+e._s(e.t(`referralProgram.referrer.${e.referrer?"titleReferrer":"title"}`))+" ")])]},proxy:!0}],null,!1,3479973179)},[e.referrer?[r("h5",[e._v(e._s(e.t("referralProgram.referrer.referredBy",{referrer:e.referrerFormatted})))]),r("p",{staticClass:"referrer-description",domProps:{innerHTML:e._s(e.t("referralProgram.referrer.info"))}})]:[r("div",{staticClass:"referrer-link-details"},[r("s-input",{staticClass:"referrer-link-code",attrs:{placeholder:e.t(`referralProgram.referrer.${e.isReferrerLinkEmpty?"placeholder":"label"}`)},scopedSlots:e._u([{key:"right",fn:function(){return[e.isReferrerLinkEmpty?e._e():r("s-button",{staticClass:"s-typography-button--mini s-button--approve",attrs:{size:"small",type:"primary",disabled:!e.isValidReferrerLink||e.isReferrerApproved},on:{click:function(t){return t.stopPropagation(),e.handleSetReferrer.apply(null,arguments)}}},[e._v(" "+e._s(e.t(`referralProgram.referrer.${e.isReferrerApproved?"approved":"approve"}`))+" ")])]},proxy:!0}],null,!1,247624632),model:{value:e.referrerLinkOrCode,callback:function(t){e.referrerLinkOrCode=t},expression:"referrerLinkOrCode"}})],1),r("p",{staticClass:"referrer-description",domProps:{innerHTML:e._s(e.t("referralProgram.referrer.description"))}})],e.referrer?r("s-card",{attrs:{shadow:"always",size:"small","border-radius":"medium"}},[r("div",{staticClass:"referrer-link-details with-text"},[r("div",{staticClass:"referral-link-label"},[e._v(e._s(e.t("referralProgram.referrer.referredLablel")))]),r("div",{staticClass:"referral-link",domProps:{innerHTML:e._s(e.referrerLink.label)}})])]):e._e()],2)],1)]:[r("p",{staticClass:"referral-program-hint",domProps:{innerHTML:e._s(e.t("referralProgram.connectAccount"))}}),e.isLoggedIn?e._e():r("s-button",{staticClass:"connect-button s-typography-button--large",attrs:{type:"primary"},on:{click:e.connectSoraWallet}},[e._v(" "+e._s(e.t("connectWalletText"))+" ")])]],2)},$=[],W=M(a,X,$,!1,null,"1260388c");const V=W.exports;export{V as default};
