var p=Object.defineProperty;var w=(i,t,s)=>t in i?p(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var n=(i,t,s)=>w(i,typeof t!="symbol"?t+"":t,s);import{m as g,$ as L,h as u,C as b}from"./index-BHqySXo4.js";var l=Object.defineProperty,d=Object.getOwnPropertyDescriptor,h=(i,t,s,o)=>{for(var e=o>1?void 0:o?d(t,s):t,a=i.length-1,c;a>=0;a--)(c=i[a])&&(e=(o?c(t,s,e):c(e))||e);return o&&e&&l(t,s,e),e};let r=class extends g(L.LoadingMixin){constructor(){super(...arguments);n(this,"isLoggedIn");n(this,"nodeIsConnected");n(this,"startSubscriptionsList",[]);n(this,"resetSubscriptionsList",[]);n(this,"trackLogin",!0);n(this,"watcherLogin",null);n(this,"trackConnection",!0);n(this,"watcherConnection",null)}watchLogin(){this.trackLogin&&(this.watcherLogin=this.$watch(()=>this.isLoggedIn,t=>this.restartSubscriptions(t)))}unwatchLogin(){var t;(t=this.watcherLogin)==null||t.call(this),this.watcherLogin=null}watchConnection(){this.trackConnection&&(this.watcherConnection=this.$watch(()=>this.nodeIsConnected,t=>this.restartSubscriptions(t)))}unwatchConnection(){var t;(t=this.watcherConnection)==null||t.call(this),this.watcherConnection=null}get subscriptionsDataLoading(){return this.parentLoading||this.loading}beforeMount(){this.watchLogin(),this.watchConnection(),this.updateSubscriptions()}beforeDestroy(){this.unwatchLogin(),this.unwatchConnection()}async beforeRouteLeave(t,s,o){await this.resetSubscriptions(),o()}setStartSubscriptions(t){this.startSubscriptionsList=t}setResetSubscriptions(t){this.resetSubscriptionsList=t}async updateSubscriptions(){this.loading||await this.withApi(async()=>{await this.withParentLoading(async()=>{await Promise.all(this.startSubscriptionsList.map(t=>t==null?void 0:t()))})})}async resetSubscriptions(){await Promise.all(this.resetSubscriptionsList.map(t=>t==null?void 0:t()))}async restartSubscriptions(t){t?await this.updateSubscriptions():await this.resetSubscriptions()}};h([u.wallet.account.isLoggedIn],r.prototype,"isLoggedIn",2);h([u.settings.nodeIsConnected],r.prototype,"nodeIsConnected",2);r=h([b],r);export{r as S};
