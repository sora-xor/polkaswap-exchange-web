var p=Object.defineProperty;var P=(a,t,s)=>t in a?p(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var c=(a,t,s)=>P(a,typeof t!="symbol"?t+"":t,s);import{m as H,$ as g,f as u,k as v,g as m,W as b,C as k,l as y,j as f,_ as d,n as _}from"./index-BHqySXo4.js";import{B as w}from"./BridgeHistoryMixin-G3tlRVUy.js";import{B as x}from"./BridgeMixin-B7wtyjiP.js";import{N as C}from"./NetworkFormatterMixin-DdB_9in4.js";import"./WalletConnectMixin-CatA0t7p.js";var S=Object.defineProperty,A=Object.getOwnPropertyDescriptor,h=(a,t,s,e)=>{for(var r=e>1?void 0:e?A(t,s):t,i=a.length-1,o;i>=0;i--)(o=a[i])&&(r=(e?o(t,s,r):o(r))||r);return e&&r&&S(t,s,r),r};const B=["assetAddress","symbol","hash","blockId","txId","externalBlockId","externalHash","parachainBlockId","parachainHash","relaychainBlockId","relaychainHash"];let n=class extends H(x,w,C,g.PaginationSearchMixin,g.NumberFormatterMixin){constructor(){super(...arguments);c(this,"updateBridgeHistory");c(this,"registeredAssets");c(this,"historyPage");c(this,"pageAmount",8)}fetchNetworkHistory(){this.withParentLoading(async()=>{this.updateBridgeHistory(),this.historyPage!==1&&(this.currentPage=this.historyPage,this.currentPage!==1&&this.currentPage===this.lastPage&&(this.isLtrDirection=!1))})}get historyList(){return Object.values(this.history)}get filteredHistory(){return this.getFilteredHistory(this.sortTransactions(this.historyList,this.isLtrDirection))}get total(){return this.filteredHistory.length}get hasHistory(){return this.filteredHistoryItems&&this.total>0}get filteredHistoryItems(){const s=this.isLtrDirection?Math.min(this.currentPage*this.pageAmount,this.filteredHistory.length):Math.max((this.lastPage-this.currentPage+1)*this.pageAmount-this.directionShift,0),e=this.isLtrDirection?Math.max(s-this.pageAmount,0):Math.max((this.lastPage-this.currentPage)*this.pageAmount-this.directionShift,0);return this.sortTransactions(this.getPageItems(this.filteredHistory,e,s),!0)}getFilteredHistory(s){if(!this.query)return s;const e=this.query.toLowerCase().trim();return s.filter(r=>{const i=this.registeredAssets[r.assetAddress],o=[i==null?void 0:i.address];return B.forEach(l=>{l in r&&o.push(r[l])}),o.some(l=>String(l).toLowerCase().includes(e))})}formatAmount(s,e=!1){const r=e?s.amount2??s.amount:s.amount;if(!s.assetAddress||!r)return"";const i=this.registeredAssets[s.assetAddress],o=i==null?void 0:i.decimals;return this.formatStringValue(r,o)}historyStatusClasses(s){const e="history-item-status",r=[e];return this.isWaitingForAction(s)?r.push(`${e}--info`):this.isFailedState(s)?r.push(`${e}--error`):this.isSuccessState(s)?r.push(`${e}--success`):r.push(`${e}--pending`),r.join(" ")}historyStatusIconName(s){return this.isWaitingForAction(s)?"notifications-alert-triangle-24":this.isFailedState(s)?"basic-clear-X-24":this.isSuccessState(s)?"basic-check-marks-24":"time-time-24"}historyStatusText(s){return this.isWaitingForAction(s)?this.t("bridgeHistory.statusAction"):""}async handlePaginationClick(s){let e=1;switch(s){case u.PaginationButton.Prev:e=this.currentPage-1;break;case u.PaginationButton.Next:e=this.currentPage+1,e===this.lastPage&&(this.isLtrDirection=!1);break;case u.PaginationButton.First:this.isLtrDirection=!0;break;case u.PaginationButton.Last:e=this.lastPage,this.isLtrDirection=!1;break}this.currentPage=e,this.setHistoryPage(this.currentPage)}handleBack(){this.setHistoryPage(1),this.navigateToBridge()}handleResetSearch(){this.resetPage(),this.resetSearch()}};h([v.bridge.updateBridgeHistory],n.prototype,"updateBridgeHistory",2);h([m.assets.registeredAssets],n.prototype,"registeredAssets",2);h([m.bridge.historyPage],n.prototype,"historyPage",2);h([b("networkSelected",{immediate:!0})],n.prototype,"fetchNetworkHistory",1);n=h([k({components:{GenericPageHeader:y(f.GenericPageHeader),BridgeNetworkSelector:y(f.BridgeNetworkSelector),SearchInput:d.SearchInput,FormattedAmount:d.FormattedAmount,HistoryPagination:d.HistoryPagination}})],n);var L=function(){var t=this,s=t._self._c;return t._self._setupProxy,s("div",{staticClass:"history-container"},[s("s-card",{directives:[{name:"loading",rawName:"v-loading",value:t.parentLoading,expression:"parentLoading"}],staticClass:"history-content",attrs:{"border-radius":"medium",shadow:"always",primary:""}},[s("generic-page-header",{attrs:{title:t.t("bridgeHistory.title")},scopedSlots:t._u([{key:"back",fn:function(){return[s("s-button",{attrs:{type:"action",icon:"arrows-chevron-left-rounded-24"},on:{click:t.handleBack}})]},proxy:!0}])},[s("div",{staticClass:"history-header-buttons"},[s("s-button",{class:["history-restore-btn",{loading:t.networkHistoryLoading}],attrs:{type:"action",icon:"arrows-swap-90-24",disabled:t.networkHistoryLoading,tooltip:t.t("bridgeHistory.restoreHistory")},on:{click:function(e){return t.updateExternalHistory(!0)}}}),s("bridge-network-selector")],1)]),s("s-form",{staticClass:"history-form",attrs:{"show-message":!1}},[t.historyList.length?s("search-input",{staticClass:"history--search",attrs:{placeholder:t.t("bridgeHistory.filterPlaceholder"),autofocus:""},on:{clear:t.handleResetSearch},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}}):t._e(),s("div",{staticClass:"history-items"},[t.hasHistory?t._l(t.filteredHistoryItems,function(e){return s("div",{directives:[{name:"button",rawName:"v-button"}],key:`history-${e.id}`,staticClass:"history-item",attrs:{tabindex:"0"},on:{click:function(r){return t.showHistory(e.id)}}},[s("div",{staticClass:"history-item-info"},[s("div",{staticClass:"history-item-title p4"},[s("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.formatAmount(e,!1),"asset-symbol":e.symbol}}),s("i",{class:`network-icon network-icon--${t.getNetworkIcon(t.isOutgoingTx(e)?0:e.externalNetwork)}`}),s("span",{staticClass:"history-item-title-separator"},[t._v(" "+t._s(t.t("bridgeTransaction.for"))+" ")]),s("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.formatAmount(e,!0),"asset-symbol":e.symbol}}),s("i",{class:`network-icon network-icon--${t.getNetworkIcon(t.isOutgoingTx(e)?e.externalNetwork:0)}`})],1),s("div",{staticClass:"history-item-date"},[t._v(t._s(t.formatDatetime(e)))])]),s("div",{class:t.historyStatusClasses(e)},[s("div",{staticClass:"history-item-status-text"},[t._v(t._s(t.historyStatusText(e)))]),s("s-icon",{staticClass:"history-item-status-icon",attrs:{name:t.historyStatusIconName(e),size:"16"}})],1)])}):s("p",{staticClass:"history-empty p4"},[t._v(t._s(t.t("bridgeHistory.empty")))]),t.hasHistory?s("history-pagination",{attrs:{"current-page":t.currentPage,"page-amount":t.pageAmount,total:t.total,"last-page":t.lastPage},on:{"pagination-click":t.handlePaginationClick}}):t._e()],2)],1)],1)],1)},I=[],N=_(n,L,I,!1,null,"ef303f45");const j=N.exports;export{j as default};
