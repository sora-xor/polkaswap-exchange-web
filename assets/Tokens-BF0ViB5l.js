var b=Object.defineProperty;var v=(s,e,t)=>e in s?b(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var c=(s,e,t)=>v(s,typeof e!="symbol"?e+"":e,t);import{ab as h,ac as _,f as x,b as i,m as C,Z as S,aI as p,K as D,gz as k,g as F,C as w,_ as l,l as d,j as m,n as P}from"./index-BHqySXo4.js";import{E as U}from"./ExplorePageMixin-CkKfV7ro.js";import"./ScrollableTableMixin-C9crfC47.js";const{IndexerType:g}=x,q=h`
  query AssetsQuery($after: Cursor, $filter: AssetFilter) {
    data: assets(orderBy: ID_ASC, after: $after, filter: $filter) {
      pageInfo {
        hasNextPage
        endCursor
      }
      edges {
        node {
          id
          priceUSD
          priceChangeDay
          priceChangeWeek
          volumeDayUSD
          volumeWeekUSD
          liquidity
          liquidityBooks
          velocity
        }
      }
    }
  }
`,A=h`
  query AssetsConnectionQuery($after: String, $where: AssetWhereInput) {
    data: assetsConnection(orderBy: id_ASC, after: $after, where: $where) {
      pageInfo {
        hasNextPage
        endCursor
      }
      edges {
        node {
          id
          priceUSD
          priceChangeDay
          priceChangeWeek
          volumeDayUSD
          volumeWeekUSD
          liquidity
          liquidityBooks
          velocity
        }
      }
    }
  }
`,y=s=>{const e=new i.FPNumber(s.priceUSD??0),t=i.FPNumber.fromCodecValue(s.liquidity??0),r=i.FPNumber.fromCodecValue(s.liquidityBooks??0),o=t.add(r).mul(e);return{[s.id]:{priceUSD:e,priceChangeDay:new i.FPNumber(s.priceChangeDay??0),priceChangeWeek:new i.FPNumber(s.priceChangeWeek??0),volumeDayUSD:new i.FPNumber(s.volumeDayUSD??0),volumeWeekUSD:new i.FPNumber(s.volumeWeekUSD??0),tvlUSD:o,velocity:new i.FPNumber(s.velocity??0)}}},N=s=>{const e={or:[{liquidity:{greaterThan:"0"}},{liquidityBooks:{greaterThan:"0"}}]};return s.length&&(e.id={in:s}),e},I=s=>{const e={OR:[{liquidity_gt:"0"},{liquidityBooks_gt:"0"}]};return s.length&&(e.id_in=s),e};async function W(s){const e=s.map(a=>a.address),t=_();let r;switch(t.type){case g.SUBQUERY:{const o={filter:N(e)};r=await t.services.explorer.fetchAllEntities(q,o,y);break}case g.SUBSQUID:{const o={where:I(e)};r=await t.services.explorer.fetchAllEntitiesConnection(A,o,y);break}}return r?r.reduce((a,o)=>({...a,...o}),{}):{}}var T=Object.defineProperty,B=Object.getOwnPropertyDescriptor,f=(s,e,t,r)=>{for(var a=r>1?void 0:r?B(e,t):e,o=s.length-1,n;o>=0;o--)(n=s[o])&&(a=(r?n(e,t,a):n(a))||a);return r&&a&&T(e,t,a),a};let u=class extends C(U){constructor(){super(...arguments);c(this,"assetsFilter");c(this,"tokensData",{})}get hasTokensData(){return Object.keys(this.tokensData).length!==0}get items(){return this.hasTokensData?Object.entries(this.tokensData).reduce((t,[r,a])=>{const o=this.getAsset(r);return o&&t.push({...o,price:a.priceUSD.toNumber(),priceFormatted:a.priceUSD.toLocaleString(7),priceChangeDay:a.priceChangeDay.toNumber(),priceChangeDayFP:a.priceChangeDay,priceChangeWeek:a.priceChangeWeek.toNumber(),priceChangeWeekFP:a.priceChangeWeek,volumeDay:a.volumeDayUSD.toNumber(),volumeDayFormatted:p(a.volumeDayUSD),tvl:a.tvlUSD.toNumber(),tvlFormatted:p(a.tvlUSD),velocity:a.velocity.toNumber(),velocityFormatted:String(a.velocity.toNumber(2))}),t},[]):this.allowedAssets.map(t=>{const r=i.FPNumber.fromCodecValue(this.getAssetFiatPrice(t)??S);return{...t,price:r.toNumber(),priceFormatted:r.toLocaleString(7)}})}get defaultSorted(){return[...this.items].sort((t,r)=>D(t,r))}get prefilteredItems(){return this.currentPage=1,k(this.defaultSorted,this.assetsFilter)}async updateExploreData(){await this.withLoading(async()=>{await this.withParentLoading(async()=>{this.tokensData=Object.freeze(await W(this.allowedAssets))})})}};f([F.wallet.settings.assetsFilter],u.prototype,"assetsFilter",2);u=f([w({components:{AssetsFilter:l.AssetsFilter,PriceChange:d(m.PriceChange),SortButton:d(m.SortButton),TokenAddress:l.TokenAddress,TokenLogo:l.TokenLogo,FormattedAmount:l.FormattedAmount,HistoryPagination:l.HistoryPagination}})],u);var E=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("assets-filter",{staticClass:"token-filter-options"}),t("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingState,expression:"loadingState"}],ref:"table",staticClass:"explore-table",attrs:{data:e.tableItems,"highlight-current-row":!1,size:"small"}},[t("s-table-column",{attrs:{"min-width":"290",label:"#"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"explore-table-item-index"},[t("span",{directives:[{name:"button",rawName:"v-button"}],class:["explore-table-item-index--head",{active:e.isDefaultSort}],on:{click:e.handleResetSort}},[e._v(" # ")])]),t("div",{staticClass:"explore-table-item-logo"},[t("s-icon",{staticClass:"explore-table-item-logo--head",attrs:{name:"various-bone-24",size:"14px"}})],1),t("div",{staticClass:"explore-table-item-info explore-table-item-info--head"},[t("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("nameText")))]),t("span",{staticClass:"explore-table__secondary"},[e._v("("+e._s(e.t("tokens.assetId"))+")")])])]},proxy:!0},{key:"default",fn:function({$index:r,row:a}){return[t("span",{staticClass:"explore-table-item-index explore-table-item-index--body"},[e._v(e._s(r+e.startIndex+1))]),t("token-logo",{staticClass:"explore-table-item-logo",attrs:{"token-symbol":a.symbol}}),t("div",{staticClass:"explore-table-item-info explore-table-item-info--body"},[t("div",{staticClass:"explore-table-item-name"},[e._v(e._s(a.symbol))]),t("div",{staticClass:"explore-table__secondary explore-table__token-name"},[e._v(e._s(a.name))]),t("div",{staticClass:"explore-table-item-address"},[t("token-address",{staticClass:"explore-table-item-address__value",attrs:{"show-name":!1,name:a.name,symbol:a.symbol,address:a.address}})],1)])]}}])}),t("s-table-column",{key:"price",attrs:{"min-width":"130","header-align":"left",align:"left"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"price",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("Price")])])]},proxy:!0},{key:"default",fn:function({row:r}){return[t("formatted-amount",{staticClass:"explore-table-item-price",attrs:{"is-fiat-value":"","fiat-default-rounding":"","font-weight-rate":e.FontWeightRate.MEDIUM,value:r.priceFormatted}})]}}])}),e.hasTokensData?[t("s-table-column",{attrs:{"min-width":"104","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"priceChangeDay",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("1D %")])])]},proxy:!0},{key:"default",fn:function({row:r}){return[t("price-change",{attrs:{value:r.priceChangeDayFP}})]}}],null,!1,3047827492)}),t("s-table-column",{attrs:{"min-width":"104","header-align":"left",align:"left"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"priceChangeWeek",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("7D %")])])]},proxy:!0},{key:"default",fn:function({row:r}){return[t("price-change",{attrs:{value:r.priceChangeWeekFP}})]}}],null,!1,2114517730)}),t("s-table-column",{attrs:{"min-width":"104","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"volumeDay",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("1D Vol.")])])]},proxy:!0},{key:"default",fn:function({row:r}){return[t("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"is-fiat-value":"","font-weight-rate":e.FontWeightRate.MEDIUM,value:r.volumeDayFormatted.amount}},[e._v(" "+e._s(r.volumeDayFormatted.suffix)+" ")])]}}],null,!1,2245760288)}),t("s-table-column",{attrs:{"min-width":"104","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"tvl",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.TVL))]),t("s-tooltip",{attrs:{"border-radius":"mini",content:e.t("tooltips.tvl")}},[t("s-icon",{attrs:{name:"info-16",size:"14px"}})],1)],1)]},proxy:!0},{key:"default",fn:function({row:r}){return[t("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"is-fiat-value":"","font-weight-rate":e.FontWeightRate.MEDIUM,value:r.tvlFormatted.amount}},[e._v(" "+e._s(r.tvlFormatted.suffix)+" ")])]}}],null,!1,2220507479)}),t("s-table-column",{attrs:{"min-width":"88","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"velocity",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("VC.")]),t("s-tooltip",{attrs:{"border-radius":"mini"},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",[e._v(e._s(e.t("tooltips.velocity")))]),t("br"),t("span",{staticStyle:{"font-weight":"500"}},[e._v("Velocity = Trading Volume USD / Market Cap USD")])]},proxy:!0}],null,!1,4378801)},[t("s-icon",{attrs:{name:"info-16",size:"14px"}})],1)],1)]},proxy:!0},{key:"default",fn:function({row:r}){return[t("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"font-weight-rate":e.FontWeightRate.MEDIUM,value:r.velocityFormatted}})]}}],null,!1,1611012200)})]:e._e()],2),t("history-pagination",{staticClass:"explore-table-pagination",attrs:{"current-page":e.currentPage,"page-amount":e.pageAmount,total:e.total,"last-page":e.lastPage,loading:e.loadingState},on:{"pagination-click":e.handlePaginationClick}})],1)},M=[],V=P(u,E,M,!1,null,"7e354147");const j=V.exports;export{j as default};
