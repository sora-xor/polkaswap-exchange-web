var w=Object.defineProperty;var x=(r,e,t)=>e in r?w(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var s=(r,e,t)=>x(r,typeof e!="symbol"?e+"":e,t);import{m as k,$ as v,a5 as R,X as y,b as f,hm as A,d as O,gX as X,f as F,g as B,C as N,l as L,j as D,_,n as M}from"./index-BHqySXo4.js";import T from"./BurnDialog-LqCGUSw8.js";import{f as E}from"./burnXor-Bp8P8SgZ.js";var P=Object.defineProperty,S=Object.getOwnPropertyDescriptor,p=(r,e,t,a)=>{for(var i=a>1?void 0:a?S(e,t):e,l=r.length-1,c;l>=0;l--)(c=r[l])&&(i=(a?c(e,t,i):c(i))||i);return a&&i&&P(e,t,i),i};const h="0";let u=class extends k(v.LoadingMixin,v.FormattedAmountMixin,R){constructor(){super(...arguments);s(this,"xor",y);s(this,"blockDuration",6e3);s(this,"defaultBurned",{chameleon:f.FPNumber.ZERO,kensetsu:f.FPNumber.ZERO});s(this,"campaignsObj",{chameleon:{id:"chameleon",title:"Reserve KARMA by burning your XOR",description:"Burn 100M XOR (permanently remove from your wallet) on SORA for KARMA in a fair launch; KARMA token is a reward token for LPs who provide liquidity to Chameleon liquidity pools. 22 days only (till Jun 6 2024).",link:"https://medium.com/@shibarimoto/earn-karma-with-a-sora-chameleon-01b25c12fd49",receivedAsset:{symbol:"KARMA",address:"",name:"Chameleon",decimals:18},rate:1e8,max:1e3,min:.1,from:15739737,fromTimestamp:17157915e5,to:16056666,toTimestamp:1717693074e3,disabledText:"Already distributed"},kensetsu:{id:"kensetsu",title:"Reserve KEN by burning your XOR",description:"Burn 1M XOR (permanently remove from your wallet) on SORA for KEN in a fair launch of Kensetsu; KEN incentivizes liquidity and is deflationary token with a status symbol appeal. 30 days only (till Mar 20 2024).",link:"https://medium.com/@shibarimoto/kensetsu-ken-356077ebee78",receivedAsset:A,rate:1e6,max:1e4,min:1,from:14464e3,fromTimestamp:170809728e4,to:14939200,toTimestamp:1710949772883,disabledText:"Already distributed"}});s(this,"campaigns",Object.values(this.campaignsObj));s(this,"interval",null);s(this,"totalXorBurned",{...this.defaultBurned});s(this,"accountXorBurned",{...this.defaultBurned});s(this,"timeLeftFormatted",{chameleon:"30D",kensetsu:"30D"});s(this,"ended",{chameleon:!1,kensetsu:!1});s(this,"burnDialogVisible",!1);s(this,"selectedReceivedAsset",this.campaigns[0].receivedAsset);s(this,"selectedBurnedAsset",y);s(this,"selectedRate",this.campaigns[0].rate);s(this,"selectedMax",this.campaigns[0].max);s(this,"selectedMin",this.campaigns[0].min);s(this,"blockNumber");s(this,"soraNetwork")}get minBlock(){return Math.min(...this.campaigns.map(e=>e.from))}get maxBlock(){return Math.max(...this.campaigns.map(e=>e.to))}getFormattedXor(e){return this.getFPNumber(e).toLocaleString()}getFormattedXorFiat(e){return this.getFiatAmountByString(`${e}`,this.xor)}getFormattedTotalXorBurned(e){var t;return((t=this.totalXorBurned[e])==null?void 0:t.toLocaleString())??h}getFormattedTotalReserved(e,t){var a;return((a=this.totalXorBurned[e])==null?void 0:a.div(t).toLocaleString(3))??h}getFormattedAccountXorBurned(e){var t;return((t=this.accountXorBurned[e])==null?void 0:t.toLocaleString())??h}getFormattedAccountReserved(e,t){var a;return((a=this.accountXorBurned[e])==null?void 0:a.div(t).toLocaleString(3))??h}calcCountdown(){for(const e of this.campaigns){const t=(e.to-this.blockNumber)*this.blockDuration;if(t<=0){this.timeLeftFormatted[e.id]="0D 0H 0M",this.ended[e.id]=!0;continue}const a=O.duration(t);this.timeLeftFormatted[e.id]=a.format("D[D] HH[H] mm[M]")}}async fetchData(){const e=this.minBlock,t=this.maxBlock,a=this.soraAddress,i=await E(e,t),l={...this.defaultBurned},c={...this.defaultBurned};for(const n of this.campaigns){const b=i.filter(({blockHeight:o})=>o>=n.from&&o<=n.to).reduce((o,{address:d,amount:C})=>(o[d]||(o[d]=f.FPNumber.ZERO),o[d]=o[d].add(C),o),{}),g=new f.FPNumber(n.rate*n.min);Object.entries(b).forEach(([o,d])=>{d.gte(g)&&(c[n.id]=c[n.id].add(d),a===o&&(l[n.id]=l[n.id].add(d)))})}this.accountXorBurned={...l},this.totalXorBurned={...c}}async fetchDataAndCalcCountdown(){await this.withLoading(async()=>{this.calcCountdown(),await this.fetchData()})}handleBurnClick(e){const t=this.campaignsObj[e];this.selectedReceivedAsset=t.receivedAsset,this.selectedRate=t.rate,this.selectedMax=t.max,this.selectedMin=t.min,this.burnDialogVisible=!0}async mounted(){await this.withApi(async()=>{(this.soraNetwork??await X())!==F.SoraNetwork.Prod&&(this.campaignsObj.chameleon.from=11e3,this.campaignsObj.chameleon.to=1e6,this.campaignsObj.kensetsu.from=0,this.campaignsObj.kensetsu.to=1e4),await this.fetchDataAndCalcCountdown(),this.interval=setInterval(this.fetchDataAndCalcCountdown,6e4)})}handleBurnConfirm(e){e&&(this.loading=!0)}beforeUnmount(){this.interval&&clearInterval(this.interval)}};p([B.wallet.settings.blockNumber],u.prototype,"blockNumber",2);p([B.wallet.settings.soraNetwork],u.prototype,"soraNetwork",2);u=p([N({components:{GenericPageHeader:L(D.GenericPageHeader),InfoLine:_.InfoLine,ExternalLink:_.ExternalLink,BurnDialog:T}})],u);var j=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"burn-container s-flex-column"},[t("s-row",{attrs:{gutter:16}},e._l(e.campaigns,function({id:a,title:i,description:l,link:c,receivedAsset:n,rate:m,disabledText:b}){return t("s-col",{key:a,staticClass:"burn-column s-flex",attrs:{xs:12,sm:12,md:12,lg:6,xl:6}},[t("s-form",{directives:[{name:"loading",rawName:"v-loading",value:e.parentLoading,expression:"parentLoading"}],staticClass:"container container--burn el-form--actions",class:{disabled:e.ended[a]},attrs:{"show-message":!1}},[t("generic-page-header",{staticClass:"page-header--burn",attrs:{title:i}}),t("p",{staticClass:"description centered p4"},[e._v(" "+e._s(l)+" ")]),t("external-link",{staticClass:"p4 link",attrs:{title:"Read more",href:c}}),t("info-line",{attrs:{label:`1 ${n.symbol}`,value:e.getFormattedXor(m),"asset-symbol":e.xor.symbol,"fiat-value":e.getFormattedXorFiat(m),"is-formatted":""}}),t("info-line",{attrs:{label:"Time left",value:e.timeLeftFormatted[a]}}),t("info-line",{attrs:{label:`Your reserved ${n.symbol} tokens`,value:e.getFormattedAccountReserved(a,m),"asset-symbol":n.symbol,"is-formatted":"","value-can-be-hidden":""}}),t("info-line",{attrs:{label:"Your burned XOR tokens",value:e.getFormattedAccountXorBurned(a),"asset-symbol":e.xor.symbol,"is-formatted":"","value-can-be-hidden":""}}),t("div",{staticClass:"info-card-container s-flex"},[t("div",{staticClass:"info-card-item s-flex-column"},[t("span",{staticClass:"info-card-title"},[e._v("TOTAL XOR BURNED")]),t("span",{staticClass:"info-card-value"},[e._v(" "+e._s(e.getFormattedTotalXorBurned(a))+" ")])]),t("div",{staticClass:"info-card-item s-flex-column"},[t("span",{staticClass:"info-card-title"},[e._v("TOTAL "+e._s(n.symbol)+" RESERVED")]),t("span",{staticClass:"info-card-value"},[e._v(" "+e._s(e.getFormattedTotalReserved(a,m))+" ")])])]),e.isLoggedIn?t("s-button",{staticClass:"action-button s-typography-button--large",attrs:{type:"primary",disabled:e.ended[a],loading:e.parentLoading||!e.ended[a]&&e.loading},on:{click:function(g){return e.handleBurnClick(a)}}},[e.ended[a]?[e._v(e._s(b??"TIME IS OVER"))]:[e._v("BURN MY XOR")]],2):t("s-button",{staticClass:"action-button s-typography-button--large",attrs:{type:"primary"},on:{click:e.connectSoraWallet}},[e._v(" "+e._s(e.t("connectWalletText"))+" ")])],1)],1)}),1),t("s-card",{staticClass:"burn-info",attrs:{"border-radius":"small",shadow:"always",size:"medium",pressed:""}},[t("div",{staticClass:"burn-info__content s-flex-column"},[t("div",{staticClass:"burn-info__desc s-flex"},[t("p",{staticClass:"description p4"},[e._v(" The 'Burn XOR' is a community-proposed initiative. Itâ€™s not officially endorsed by any centralized authority or organization. Participation and interaction with the 'Burn XOR' should be considered with understanding of its community-driven nature. ")]),t("div",{staticClass:"burn-info__badge"},[t("s-icon",{staticClass:"burn-info__icon",attrs:{name:"notifications-alert-triangle-24",size:"24"}})],1)])])]),t("burn-dialog",{attrs:{visible:e.burnDialogVisible,"received-asset":e.selectedReceivedAsset,"burned-asset":e.selectedBurnedAsset,rate:e.selectedRate,max:e.selectedMax,min:e.selectedMin},on:{"update:visible":function(a){e.burnDialogVisible=a},confirm:e.handleBurnConfirm}})],1)},I=[],K=M(u,j,I,!1,null,"a47e08e2");const Z=K.exports;export{Z as default};
