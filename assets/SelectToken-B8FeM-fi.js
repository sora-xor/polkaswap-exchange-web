var g=Object.defineProperty;var v=(l,s,e)=>s in l?g(l,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[s]=e;var a=(l,s,e)=>v(l,typeof s!="symbol"?s+"":s,e);import{m as w,T,$ as _,aG as b,X as B,gz as S,b as m,g as p,h as A,k as C,W as k,C as L,_ as u,l as W,j as I,P as c,O as x,n as P}from"./index-BHqySXo4.js";import{S as F}from"./SelectAssetMixin-Ddh2sOj4.js";import"./SearchInputMixin-BPi4nX0e.js";var O=Object.defineProperty,D=Object.getOwnPropertyDescriptor,o=(l,s,e,t)=>{for(var n=t>1?void 0:t?D(s,e):s,r=l.length-1,d;r>=0;r--)(d=l[r])&&(n=(t?d(s,e,n):d(n))||n);return t&&n&&O(s,e,n),n};function f(l,s){return l.reduce((e,t)=>(!m.api.assets.isWhitelist(t,s)&&t.decimals&&(e[t.address]=t),e),{})}let i=class extends w(T,F,_.LoadingMixin){constructor(){super(...arguments);a(this,"connected");a(this,"asset");a(this,"disabledCustom");a(this,"isFirstTokenSelected");a(this,"isAddLiquidity");a(this,"filter");a(this,"appendToBody");a(this,"shouldBalanceBeHidden");a(this,"assets");a(this,"assetsFilter");a(this,"accountAssets");a(this,"pinnedAssetsAddresses");a(this,"libraryTheme");a(this,"whitelistAssets");a(this,"isLoggedIn");a(this,"whitelist");a(this,"whitelistIdsBySymbol");a(this,"addAsset");a(this,"tokenTabs",["assets","custom"]);a(this,"tabValue",b(this.tokenTabs))}async handleTabReset(e){e&&(this.tabValue=b(this.tokenTabs))}get nonWhitelistAssets(){return f(this.assets,this.whitelist)}get nonWhitelistAccountAssets(){return f(this.accountAssets,this.whitelist)}get whitelistAssetsList(){var h;let e=[];this.isAddLiquidity?e=this.isFirstTokenSelected?this.mainLPSources:this.whitelistAssets.filter(y=>y.address!==B.address):e=this.whitelistAssets,e=S(e,this.assetsFilter);const t=e.map(y=>y.address),n=(h=this.asset)==null?void 0:h.address;return[...this.getAssetsWithBalances(t,n)].sort(this.sortByBalance)}get filteredWhitelistTokens(){const e=this.filterAssetsByQuery(this.whitelistAssetsList)(this.searchQuery),t=new Map(this.pinnedAssetsAddresses.map((n,r)=>[n,r]));return e.sort((n,r)=>{const d=t.get(n.address),h=t.get(r.address);return d!==void 0&&h!==void 0?d-h:d!==void 0?-1:h!==void 0?1:0})}get isCustomTabActive(){return this.tabValue==="custom"}get shouldAssetsListBeShown(){return!(this.isCustomTabActive&&!this.activeAssetsList.length&&this.searchQuery)}get assetsListSize(){return this.isCustomTabActive?5:6}get activeAssetsList(){return(this.isCustomTabActive?this.sortedNonWhitelistAccountAssets:this.filteredWhitelistTokens).filter(this.filter)}get activeSearchPlaceholder(){return this.t(this.isCustomTabActive?"selectToken.custom.search":"selectToken.searchPlaceholder")}get alreadyAttached(){return!!this.nonWhitelistAccountAssets[this.searchQuery]}get customAsset(){return this.nonWhitelistAssets[this.searchQuery]??null}get sortedNonWhitelistAccountAssets(){const{asset:e}=this;return this.getAssetsWithBalances(Object.keys(this.nonWhitelistAccountAssets),e==null?void 0:e.address).sort(this.sortByBalance)}get mainLPSources(){const e=m.api.dex.poolBaseAssetsIds;return this.assets.filter(t=>e.includes(t.address))}async handleAddAsset(){this.customAsset&&(this.isLoggedIn?(await this.withLoading(async()=>await this.addAsset((this.customAsset||{}).address)),this.handleClearSearch()):this.selectAsset(this.customAsset))}handleRemoveCustomAsset(e){m.api.assets.removeAccountAsset(e.address)}handleTabChange(e){this.tabValue=e,this.clearAndFocusSearch()}};o([c({default:!1,type:Boolean})],i.prototype,"connected",2);o([c({default:x,type:Object})],i.prototype,"asset",2);o([c({default:!1,type:Boolean})],i.prototype,"disabledCustom",2);o([c({default:!1,type:Boolean})],i.prototype,"isFirstTokenSelected",2);o([c({default:!1,type:Boolean})],i.prototype,"isAddLiquidity",2);o([c({default:()=>!0,type:Function})],i.prototype,"filter",2);o([c({default:!1,type:Boolean})],i.prototype,"appendToBody",2);o([p.wallet.settings.shouldBalanceBeHidden],i.prototype,"shouldBalanceBeHidden",2);o([p.wallet.account.assets],i.prototype,"assets",2);o([p.wallet.settings.assetsFilter],i.prototype,"assetsFilter",2);o([p.wallet.account.accountAssets],i.prototype,"accountAssets",2);o([p.wallet.account.pinnedAssets],i.prototype,"pinnedAssetsAddresses",2);o([A.libraryTheme],i.prototype,"libraryTheme",2);o([A.assets.whitelistAssets],i.prototype,"whitelistAssets",2);o([A.wallet.account.isLoggedIn],i.prototype,"isLoggedIn",2);o([A.wallet.account.whitelist],i.prototype,"whitelist",2);o([A.wallet.account.whitelistIdsBySymbol],i.prototype,"whitelistIdsBySymbol",2);o([C.wallet.account.addAsset],i.prototype,"addAsset",2);o([k("visible")],i.prototype,"handleTabReset",1);i=o([L({components:{DialogBase:u.DialogBase,SelectAssetList:W(I.SelectAssetList),TokenAddress:u.TokenAddress,SearchInput:u.SearchInput,AssetsFilter:u.AssetsFilter,AddAssetDetailsCard:u.AddAssetDetailsCard}})],i);var V=function(){var s=this,e=s._self._c;return s._self._setupProxy,e("dialog-base",{attrs:{visible:s.isVisible,title:s.t("selectToken.title"),"custom-class":"asset-select","append-to-body":s.appendToBody,"modal-append-to-body":s.appendToBody},on:{"update:visible":function(t){s.isVisible=t}}},[e("s-tabs",{staticClass:"s-tabs--exchange",attrs:{value:s.tabValue,type:"rounded"},on:{input:s.handleTabChange}},[e("search-input",{ref:"search",staticClass:"token-search",attrs:{placeholder:s.activeSearchPlaceholder,autofocus:""},on:{clear:s.handleClearSearch},model:{value:s.query,callback:function(t){s.query=t},expression:"query"}}),e("s-tab",{attrs:{label:s.t("selectToken.assets.title"),name:"assets"}},[e("assets-filter",{staticClass:"token-filter-options"})],1),e("s-tab",{staticClass:"asset-select__info",attrs:{disabled:s.disabledCustom,label:s.t("selectToken.custom.title"),name:"custom"}},[s.customAsset?[s.alreadyAttached?e("span",[s._v(s._s(s.t("selectToken.custom.alreadyAttached")))]):e("add-asset-details-card",{attrs:{asset:s.customAsset,theme:s.libraryTheme,whitelist:s.whitelist,"whitelist-ids-by-symbol":s.whitelistIdsBySymbol,loading:s.loading},on:{add:s.handleAddAsset}})]:s.searchQuery?e("span",[s._v(s._s(s.t("selectToken.custom.notFound")))]):s._e(),s.connected&&s.sortedNonWhitelistAccountAssets.length?e("div",{staticClass:"token-list_text"},[s._v(" "+s._s(s.sortedNonWhitelistAccountAssets.length)+" "+s._s(s.t("selectToken.custom.text"))+" ")]):s._e()],2),e("select-asset-list",{directives:[{name:"show",rawName:"v-show",value:s.shouldAssetsListBeShown,expression:"shouldAssetsListBeShown"}],attrs:{assets:s.activeAssetsList,size:s.assetsListSize,connected:s.connected,"should-balance-be-hidden":s.shouldBalanceBeHidden,"has-fiat-value":""},on:{click:s.selectAsset},scopedSlots:s._u([{key:"action",fn:function(t){return[s.isCustomTabActive?e("div",{staticClass:"token-item__remove",on:{click:function(n){return n.stopPropagation(),s.handleRemoveCustomAsset(t)}}},[e("s-icon",{attrs:{name:"basic-trash-24"}})],1):s._e()]}}])})],1)],1)},j=[],q=P(i,V,j,!1,null,"e98be619");const M=q.exports;export{M as default};
