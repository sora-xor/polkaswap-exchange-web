var f=Object.defineProperty;var v=(n,e,t)=>e in n?f(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var a=(n,e,t)=>v(n,typeof e!="symbol"?e+"":e,t);import{m as g,$ as c,X as y,Z as b,b as h,am as _,hD as l,P as p,O as k,g as F,h as x,W as w,C as I,_ as m,l as S,j as B,R as C,n as A}from"./index-BHqySXo4.js";var T=Object.defineProperty,O=Object.getOwnPropertyDescriptor,r=(n,e,t,s)=>{for(var o=s>1?void 0:s?O(e,t):e,d=n.length-1,u;d>=0;d--)(u=n[d])&&(o=(s?u(e,t,o):u(o))||o);return s&&o&&T(e,t,o),o};let i=class extends g(c.TransactionMixin,c.DialogMixin,c.FormattedAmountMixin){constructor(){super(...arguments);a(this,"xorSymbol",y.symbol);a(this,"tokenInput");a(this,"balance");a(this,"editableFiat");a(this,"asset");a(this,"networkFees");a(this,"accountXor");a(this,"value","");a(this,"address","");a(this,"comment","")}async handleDialogVisibility(t){var s;await this.$nextTick(),this.value="",this.address="",this.comment="",(s=this.tokenInput)==null||s.focus()}get fpBalance(){return this.getFPNumberFromCodec(this.balance,this.asset.decimals)}get xorBalance(){var t,s;return this.getFPNumberFromCodec(((s=(t=this.accountXor)==null?void 0:t.balance)==null?void 0:s.transferable)??b,this.asset.decimals)}get assetWithBalance(){return{...this.asset,balance:{transferable:this.balance}}}get tokenSymbol(){return this.asset.symbol}get title(){return`Send ${this.tokenSymbol}`}get networkFee(){return this.networkFees[h.Operation.XorlessTransfer]}get fpNetworkFee(){return this.getFPNumberFromCodec(this.networkFee)}get networkFeeFormatted(){return this.formatCodecNumber(this.networkFee)}get emptyValue(){return!+this.value}get isMaxAvailable(){return _(this.assetWithBalance,this.value??0,this.networkFee,this.accountXor)}get isInsufficientBalance(){return this.fpBalance.sub(this.value||0).isLtZero()}get isInsufficientXorForFee(){return this.xorBalance.sub(this.fpNetworkFee).isLtZero()}get emptyAddress(){return!this.address.trim()}get validAddress(){return!this.emptyAddress&&h.api.validateAddress(this.address)}get disabled(){return this.loading||this.isInsufficientXorForFee||this.emptyValue||!this.validAddress||this.isInsufficientBalance}get valuePercent(){if(!this.value)return 0;const t=this.getFPNumber(this.value,this.asset.decimals).div(this.fpBalance).mul(l).toNumber(0);return t>l?l:t}handlePercentChange(t){this.value=this.fpBalance.mul(t/l).toString()}handleMaxValue(){this.value=this.fpBalance.toString()}handleCommentInput(t){if(/^[A-Za-z0-9 _',.#]+$/.test(t.key))return!0;t.preventDefault()}async handleSend(){const t=this.comment.trim()||void 0,s=this.address.trim();if(this.isInsufficientBalance)this.$alert(this.t("insufficientBalanceText",{tokenSymbol:this.tokenSymbol}),{title:this.t("errorText")});else try{await this.withNotifications(async()=>{await h.api.assets.transfer(this.asset,s,this.value,{feeType:"xor",comment:t})})}catch(o){console.error(o)}this.isVisible=!1}};r([C("tokenInput")],i.prototype,"tokenInput",2);r([p({default:b,type:String})],i.prototype,"balance",2);r([p({default:!1,type:Boolean})],i.prototype,"editableFiat",2);r([p({default:k,type:Object})],i.prototype,"asset",2);r([F.wallet.settings.networkFees],i.prototype,"networkFees",2);r([x.assets.xor],i.prototype,"accountXor",2);r([w("visible")],i.prototype,"handleDialogVisibility",1);i=r([I({components:{DialogBase:m.DialogBase,InfoLine:m.InfoLine,AddressBookInput:m.AddressBookInput,TokenInput:S(B.TokenInput)}})],i);var P=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("dialog-base",{attrs:{title:e.title,visible:e.isVisible,tooltip:"COMING SOON..."},on:{"update:visible":function(s){e.isVisible=s}}},[t("div",{staticClass:"dashboard-send"},[t("address-book-input",{staticClass:"dashboard-send__address",attrs:{"exclude-connected":"","is-valid":e.validAddress,disabled:e.loading},model:{value:e.address,callback:function(s){e.address=s},expression:"address"}}),t("token-input",{ref:"tokenInput",staticClass:"dashboard-send__token-input",attrs:{"with-slider":"",title:"AMOUNT","is-fiat-editable":e.editableFiat,"is-max-available":e.isMaxAvailable,token:e.asset,balance:e.balance,"slider-value":e.valuePercent,disabled:e.loading},on:{max:e.handleMaxValue,slide:e.handlePercentChange},model:{value:e.value,callback:function(s){e.value=s},expression:"value"}}),t("s-input",{staticClass:"dashboard-send__comment",attrs:{type:"textarea",placeholder:"Comment (Optional)",rows:4,maxlength:128,disabled:e.loading},nativeOn:{keypress:function(s){return e.handleCommentInput(s)}},model:{value:e.comment,callback:function(s){e.comment=s},expression:"comment"}}),t("s-button",{staticClass:"s-typography-button--large action-button dashboard-send__button",attrs:{type:"primary",disabled:e.disabled},on:{click:e.handleSend}},[e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.xorSymbol}))+" ")]:e.emptyAddress?[e._v(" "+e._s(e.t("walletSend.enterAddress"))+" ")]:e.validAddress?e.emptyValue?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:e.isInsufficientBalance?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.tokenSymbol}))+" ")]:[e._v(e._s(e.title))]:[e._v(" "+e._s(e.t("walletSend.badAddress"))+" ")]],2),t("info-line",{attrs:{label:e.t("networkFeeText"),"label-tooltip":e.t("networkFeeTooltipText"),value:e.networkFeeFormatted,"asset-symbol":e.xorSymbol,"fiat-value":e.getFiatAmountByCodecString(e.networkFee),"is-formatted":""}})],1)])},N=[],D=A(i,P,N,!1,null,"535c3488");const $=D.exports;export{$ as default};
